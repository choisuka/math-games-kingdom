<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
<title>ê·¸ë˜í”„ íƒí—˜ëŒ€ | ì¢Œí‘œì™€ í•¨ìˆ˜ | ì˜í†µìˆ˜í•™ì—¬í–‰í•™ì›</title>
<style>
:root{
  --bg:#050d1a;--bg2:#0a1628;--card:#0d1e35;
  --blue:#38bdf8;--blue2:#0ea5e9;--green:#34d399;
  --amber:#f59e0b;--red:#f87171;--purple:#a78bfa;
  --muted:#475569;--paper:#e2e8f0;--paper2:#94a3b8;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  font-family:"Segoe UI","Noto Sans KR",sans-serif;
  background:radial-gradient(ellipse at 20% 20%,#0a1628 0%,#050d1a 70%);
  min-height:100vh;padding:10px 14px;color:var(--paper);}
.wrap{width:100%;max-width:1280px;margin:0 auto}

.screen{display:none;animation:fadeIn .3s ease}
.screen.active{display:block}
@keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}

/* ===== FLASH ===== */
.flash{position:fixed;inset:0;z-index:500;pointer-events:none;opacity:0}
.flash.red{animation:fRed .5s ease forwards}
.flash.ok{animation:fOk .5s ease forwards}
@keyframes fRed{0%{background:rgba(248,113,113,.55);opacity:1}100%{opacity:0}}
@keyframes fOk{0%{background:rgba(52,211,153,.35);opacity:1}100%{opacity:0}}

/* ===== TITLE / HEADER ===== */
.hdr{
  background:linear-gradient(135deg,#061428,#0a1e3a,#061428);
  border:2px solid rgba(56,189,248,.3);border-radius:20px;
  padding:1.4rem 2rem;margin-bottom:1.2rem;
  display:flex;align-items:center;gap:1.5rem;
  box-shadow:0 0 80px rgba(56,189,248,.12);}
.hdr-icon{font-size:3.2rem;flex-shrink:0;animation:float 3s ease-in-out infinite}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
.hdr-info{flex:1}
.hdr-title{
  font-size:1.9rem;font-weight:900;
  background:linear-gradient(90deg,#38bdf8,#34d399,#a78bfa);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.hdr-sub{font-size:.82rem;color:var(--muted);margin:.2rem 0 .6rem}
.hdr-score{
  display:inline-flex;align-items:center;gap:.4rem;
  background:rgba(251,191,36,.1);border:1px solid rgba(251,191,36,.25);
  border-radius:16px;padding:.3rem .85rem;font-size:.95rem;color:#fbbf24;font-weight:700;}
.hdr-toc{font-size:.75rem;color:var(--muted);text-align:right;line-height:1.9;flex-shrink:0}

/* ===== CHAPTER GRID ===== */
.sec-label{
  font-size:.72rem;letter-spacing:.1em;text-transform:uppercase;
  color:var(--muted);margin-bottom:.75rem;text-align:center;
  border-bottom:1px solid rgba(56,189,248,.1);padding-bottom:.45rem;}
.ch-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:.7rem;margin-bottom:1rem}
@media(max-width:900px){.ch-grid{grid-template-columns:repeat(3,1fr)}}
@media(max-width:560px){.ch-grid{grid-template-columns:1fr 1fr}}
.ch-card{
  background:rgba(13,30,53,.8);border:1.5px solid rgba(56,189,248,.12);
  border-radius:16px;padding:1rem .75rem;text-align:center;cursor:pointer;
  transition:all .22s;position:relative;overflow:hidden;}
.ch-card:hover:not(.locked){
  border-color:rgba(56,189,248,.45);background:rgba(56,189,248,.07);transform:translateY(-3px);
  box-shadow:0 8px 28px rgba(56,189,248,.1);}
.ch-card.locked{opacity:.35;cursor:not-allowed}
.ch-card.done{border-color:rgba(52,211,153,.4);background:rgba(52,211,153,.04)}
.ch-num{font-size:.65rem;color:var(--muted);margin-bottom:.2rem}
.ch-emoji{font-size:1.9rem;margin-bottom:.25rem}
.ch-title{font-size:.78rem;font-weight:700;color:var(--paper);line-height:1.3}
.ch-status{font-size:.68rem;color:var(--muted);margin-top:.2rem}
.lock-icon{position:absolute;top:.35rem;right:.35rem;font-size:.75rem;opacity:.45}
.reset-btn{
  display:block;margin:.4rem auto 0;background:none;
  border:1px solid rgba(255,255,255,.08);color:var(--muted);
  border-radius:7px;padding:.26rem .7rem;font-size:.7rem;cursor:pointer;}
.reset-btn:hover{border-color:rgba(248,113,113,.3);color:#f87171}

/* ===== LECTURE OVERLAY ===== */
.lec-overlay{
  display:none;position:fixed;inset:0;z-index:300;
  background:rgba(0,0,0,.93);backdrop-filter:blur(14px);
  align-items:center;justify-content:center;padding:1rem;overflow-y:auto;}
.lec-overlay.show{display:flex;animation:oIn .2s ease}
@keyframes oIn{from{opacity:0}to{opacity:1}}
.lec-modal{
  width:100%;max-width:700px;margin:auto;
  background:linear-gradient(160deg,#061020,#0a1c38,#040c1e);
  border:2px solid rgba(56,189,248,.4);border-radius:24px;
  padding:2rem 2rem 1.8rem;
  box-shadow:0 0 80px rgba(56,189,248,.25);
  animation:slideUp .4s cubic-bezier(.34,1.56,.64,1);}
@keyframes slideUp{from{transform:translateY(50px);opacity:0}to{transform:none;opacity:1}}
.lec-dots{display:flex;gap:.4rem;justify-content:center;margin-bottom:1.1rem}
.ldot{width:8px;height:8px;border-radius:50%;background:rgba(255,255,255,.15);transition:.3s}
.ldot.on{background:var(--blue);box-shadow:0 0 8px rgba(56,189,248,.7)}
.ldot.past{background:var(--green)}
.lec-badge{
  display:inline-block;background:rgba(56,189,248,.15);border:1px solid rgba(56,189,248,.3);
  border-radius:10px;padding:.18rem .65rem;font-size:.7rem;color:#7dd3fc;
  font-weight:600;margin-bottom:.6rem;}
.lec-h{font-size:1.4rem;font-weight:900;color:#fff;margin-bottom:.5rem;
  text-shadow:0 0 20px rgba(56,189,248,.4)}
.lec-b{font-size:.91rem;line-height:1.8;color:var(--paper2)}
.lec-b strong{color:var(--blue);font-weight:800;
  animation:glow .9s ease-in-out infinite alternate;}
@keyframes glow{from{text-shadow:none}to{text-shadow:0 0 12px rgba(56,189,248,.7)}}
/* Inline canvas inside lecture */
.lec-canvas-wrap{
  margin:.9rem 0;border-radius:14px;overflow:hidden;
  border:1.5px solid rgba(56,189,248,.2);
  background:#060e1c;display:flex;justify-content:center;}
.lec-canvas-wrap canvas{display:block;max-width:100%}
.lec-formula{
  background:rgba(56,189,248,.07);border:1.5px solid rgba(56,189,248,.18);
  border-radius:12px;padding:.75rem;margin:.7rem 0;text-align:center;}
.lec-fval{font-size:1.6rem;font-weight:900;color:#fff;
  text-shadow:0 0 16px rgba(56,189,248,.4)}
.lec-fnote{font-size:.73rem;color:var(--muted);margin-top:.2rem}
.lec-tip{
  background:rgba(167,139,250,.06);border-left:3px solid var(--purple);
  border-radius:0 8px 8px 0;padding:.5rem .8rem;
  font-size:.8rem;color:#c4b5fd;margin-top:.65rem;}
.lec-nav{display:flex;gap:.65rem;margin-top:1.3rem}
.l-prev{
  padding:.65rem 1rem;border-radius:11px;border:1.5px solid rgba(56,189,248,.18);
  background:transparent;color:var(--muted);cursor:pointer;font-size:.83rem;}
.l-next,.l-start{
  flex:1;padding:.78rem;border-radius:11px;border:none;cursor:pointer;
  font-size:.9rem;font-weight:700;transition:.15s;}
.l-next{background:linear-gradient(90deg,#0ea5e9,#38bdf8);color:#fff;
  box-shadow:0 4px 16px rgba(14,165,233,.3);}
.l-start{background:linear-gradient(90deg,#059669,#10b981);color:#fff;
  box-shadow:0 4px 16px rgba(16,185,129,.3);}
.l-next:hover,.l-start:hover{transform:scale(1.02)}

/* ===== QUIZ SCREEN ===== */
.qhdr{display:flex;align-items:center;gap:.45rem;margin-bottom:.65rem;flex-wrap:wrap}
.q-pts{
  background:rgba(251,191,36,.09);border:1px solid rgba(251,191,36,.22);
  border-radius:10px;padding:.26rem .7rem;font-size:.84rem;color:#fbbf24;font-weight:700;}
.combo-el{font-size:.78rem;font-weight:700;padding:.26rem .65rem;border-radius:10px;transition:.3s}
.combo-el.c0{color:var(--muted);background:rgba(70,70,70,.1)}
.combo-el.c2{color:#60a5fa;background:rgba(96,165,250,.13)}
.combo-el.c5{color:#fbbf24;background:rgba(251,191,36,.13);animation:cPop .4s}
@keyframes cPop{0%{transform:scale(1.4)}100%{transform:scale(1)}}
.m-tag{font-size:.7rem;font-weight:700;padding:.2rem .5rem;border-radius:7px}
.m-tag.mcq{background:rgba(56,189,248,.15);color:var(--blue)}
.m-tag.fill{background:rgba(245,158,11,.15);color:var(--amber)}
.home-btn{
  margin-left:auto;background:none;border:1px solid rgba(255,255,255,.1);
  color:var(--muted);border-radius:7px;padding:.24rem .58rem;cursor:pointer;font-size:.74rem;}
/* Timer */
.timer-wrap{height:5px;background:rgba(255,255,255,.06);border-radius:3px;margin-bottom:.8rem;overflow:hidden}
.timer-bar{height:100%;border-radius:3px;transition:width .08s linear;
  background:linear-gradient(90deg,var(--blue),var(--green))}
.timer-bar.warn{background:linear-gradient(90deg,#ef4444,#f97316)}

/* Two-column quiz layout */
.quiz-body{
  display:grid;
  grid-template-columns:1fr 380px;
  gap:1.1rem;align-items:start;}
@media(max-width:920px){.quiz-body{grid-template-columns:1fr}}
.quiz-left{min-width:0}

/* Canvas card */
.canvas-card{
  background:#060e1c;border:2px solid rgba(56,189,248,.2);
  border-radius:20px;padding:.8rem;margin-bottom:.85rem;
  box-shadow:0 0 40px rgba(56,189,248,.07);
  animation:cardIn .35s cubic-bezier(.34,1.56,.64,1);}
@keyframes cardIn{from{transform:scale(.95);opacity:0}to{transform:scale(1);opacity:1}}
.canvas-tag{font-size:.67rem;color:var(--blue);font-weight:700;
  letter-spacing:.06em;margin-bottom:.35rem}
.canvas-qn{font-size:.73rem;color:var(--muted);margin-bottom:.6rem}
#graph-canvas{
  display:block;width:100%;max-width:460px;
  aspect-ratio:1/1;border-radius:12px;margin:0 auto;}
.q-text{
  font-size:1.05rem;color:var(--paper);line-height:1.65;
  margin:.65rem 0;font-weight:500;}
.hint-row{display:flex;justify-content:flex-end;margin-top:.35rem}
.hint-btn{
  background:rgba(56,189,248,.07);border:1px solid rgba(56,189,248,.2);
  border-radius:8px;padding:.25rem .65rem;font-size:.74rem;
  color:var(--blue);cursor:pointer;}
.hint-btn:hover{background:rgba(56,189,248,.15)}

/* Choices */
.choices{display:grid;grid-template-columns:1fr 1fr;gap:.5rem;margin-bottom:.7rem}
@media(max-width:560px){.choices{grid-template-columns:1fr}}
.cbtn{
  width:100%;padding:.75rem .85rem;border-radius:12px;
  border:1.5px solid rgba(56,189,248,.1);background:rgba(13,30,53,.6);
  color:var(--paper);font-size:.88rem;text-align:left;cursor:pointer;transition:all .18s;}
.cbtn:hover:not(:disabled){
  border-color:rgba(56,189,248,.38);background:rgba(56,189,248,.07);
  transform:translateX(3px);}
.cbtn.correct{border-color:var(--green);background:rgba(52,211,153,.1);color:#6ee7b7}
.cbtn.wrong{border-color:var(--red);background:rgba(248,113,113,.08);color:#fca5a5}
/* Fill */
.fill-wrap{display:flex;gap:.5rem;margin-bottom:.7rem}
.fill-input{
  flex:1;padding:.72rem .9rem;border-radius:12px;
  border:1.5px solid rgba(56,189,248,.2);background:rgba(6,14,28,.8);
  color:var(--paper);font-size:.92rem;outline:none;}
.fill-input:focus{border-color:var(--blue);box-shadow:0 0 0 3px rgba(56,189,248,.1)}
.fill-submit{
  padding:.72rem .95rem;border-radius:12px;border:none;
  background:linear-gradient(90deg,#0369a1,#0ea5e9);color:#fff;
  font-size:.86rem;font-weight:700;cursor:pointer;white-space:nowrap;}
.q-ctr{text-align:center;font-size:.73rem;color:var(--muted);margin-top:.25rem}

/* ===== CONCEPT PANEL ===== */
.concept-panel{
  position:sticky;top:1rem;
  background:linear-gradient(160deg,#060f1e,#0a1830,#060f1e);
  border:1.5px solid rgba(56,189,248,.25);border-radius:18px;
  padding:1.1rem 1rem;
  max-height:calc(100vh - 2rem);overflow-y:auto;}
.cp-title{
  font-size:.68rem;letter-spacing:.1em;color:var(--muted);
  text-transform:uppercase;margin-bottom:.65rem;
  border-bottom:1px solid rgba(56,189,248,.12);padding-bottom:.4rem;}
.cp-formulas{margin-bottom:.85rem}
.cp-f-row{
  display:flex;align-items:baseline;gap:.5rem;
  padding:.38rem .55rem;border-radius:8px;
  background:rgba(56,189,248,.05);border:1px solid rgba(56,189,248,.1);
  margin-bottom:.32rem;}
.cp-f-lbl{font-size:.63rem;color:var(--muted);flex-shrink:0;min-width:4rem}
.cp-f-val{font-size:.85rem;font-weight:700;color:var(--blue)}
.cp-why-title{
  font-size:.66rem;font-weight:700;color:var(--red);
  letter-spacing:.07em;margin-bottom:.48rem;text-transform:uppercase;}
.cp-why-item{
  margin-bottom:.6rem;padding:.52rem .62rem;border-radius:10px;
  background:rgba(56,189,248,.04);border-left:2.5px solid rgba(56,189,248,.3);}
.cp-why-q{font-size:.76rem;font-weight:700;color:var(--paper);margin-bottom:.25rem;line-height:1.4}
.cp-why-a{font-size:.74rem;color:#93c5fd;line-height:1.55}
.cp-why-a strong{color:var(--blue)}

/* ===== EXPLAIN OVERLAY ===== */
.exp-overlay{
  display:none;position:fixed;inset:0;z-index:400;
  background:rgba(0,0,0,.9);backdrop-filter:blur(10px);
  align-items:center;justify-content:center;padding:1rem;overflow-y:auto;}
.exp-overlay.show{display:flex}
.exp-modal{
  width:100%;max-width:680px;
  background:linear-gradient(160deg,#06101e,#0a1830);
  border:2.5px solid var(--red);border-radius:24px;
  padding:1.8rem 1.6rem;
  box-shadow:0 0 60px rgba(248,113,113,.4);
  animation:mPop .4s cubic-bezier(.34,1.56,.64,1);}
.exp-modal.ok{border-color:var(--green);box-shadow:0 0 60px rgba(52,211,153,.35);}
@keyframes mPop{from{transform:scale(.15) rotate(-10deg);opacity:0}to{transform:none;opacity:1}}
.exp-icon{font-size:3rem;text-align:center;display:block}
.exp-title{font-size:1.45rem;font-weight:900;text-align:center;color:var(--red);margin:.4rem 0}
.exp-title.ok{color:var(--green)}
.exp-ans-box{background:rgba(255,255,255,.04);border-radius:10px;
  padding:.55rem .9rem;margin:.6rem 0;text-align:center;}
.exp-ans-lbl{font-size:.67rem;color:var(--muted);margin-bottom:.15rem}
.exp-ans-val{font-size:1.45rem;font-weight:900;color:#fbbf24}
.exp-steps{list-style:none;padding:0;margin:.6rem 0}
.exp-steps li{
  background:rgba(255,255,255,.03);border-radius:9px;
  padding:.48rem .75rem;margin:.28rem 0;font-size:.84rem;color:var(--paper2);
  border-left:3px solid rgba(56,189,248,.25);animation:stepIn .3s ease both;}
@keyframes stepIn{from{transform:translateX(-16px);opacity:0}to{transform:none;opacity:1}}
.exp-steps li strong{color:var(--blue)}
.exp-btn{
  width:100%;padding:.78rem;border-radius:12px;border:none;cursor:pointer;
  margin-top:.9rem;font-size:.9rem;font-weight:700;
  background:linear-gradient(90deg,#0369a1,#0ea5e9);color:#fff;transition:.15s;}
.exp-btn:hover{transform:scale(1.02)}

/* ===== HINT OVERLAY ===== */
.hint-overlay{
  display:none;position:fixed;inset:0;z-index:450;
  background:rgba(0,0,0,.85);backdrop-filter:blur(8px);
  align-items:center;justify-content:center;padding:1rem;}
.hint-overlay.show{display:flex}
.hint-modal{
  width:100%;max-width:560px;
  background:linear-gradient(160deg,#061428,#0a1e3a);
  border:2px solid rgba(56,189,248,.3);border-radius:20px;
  padding:1.5rem 1.4rem;box-shadow:0 0 40px rgba(56,189,248,.2);}
.hint-title{font-size:1.1rem;font-weight:900;color:var(--blue);margin-bottom:.6rem}
.hint-body{font-size:.88rem;color:var(--paper2);line-height:1.7;margin-bottom:.7rem}
.hint-close{
  width:100%;padding:.68rem;border-radius:10px;
  border:1px solid rgba(56,189,248,.22);background:rgba(56,189,248,.07);
  color:var(--blue);font-size:.87rem;cursor:pointer;}

/* ===== MODE SWITCH ===== */
.msb{
  display:none;position:fixed;top:50%;left:50%;
  transform:translate(-50%,-50%) scale(0);z-index:600;
  background:linear-gradient(90deg,#0a2a4a,#0e3a6a,#0a2a4a);
  border:2px solid var(--blue);border-radius:18px;
  padding:1.3rem 2rem;text-align:center;
  box-shadow:0 0 60px rgba(56,189,248,.5);}
.msb.show{display:block;animation:msbA .6s cubic-bezier(.34,1.56,.64,1) forwards}
@keyframes msbA{
  0%{transform:translate(-50%,-50%) scale(0);opacity:0}
  60%{transform:translate(-50%,-50%) scale(1.08)}
  100%{transform:translate(-50%,-50%) scale(1);opacity:1}}
.msb-e{font-size:2.5rem;display:block;margin-bottom:.25rem}
.msb-t{font-size:1.2rem;font-weight:900;color:var(--blue)}
.msb-s{font-size:.8rem;color:#7dd3fc;margin-top:.15rem}

/* ===== DONE SCREEN ===== */
.done-card{
  background:linear-gradient(160deg,#031828,#051e36);
  border:2px solid rgba(52,211,153,.3);border-radius:22px;
  padding:2rem 1.5rem;text-align:center;margin-bottom:1rem;
  box-shadow:0 0 50px rgba(52,211,153,.15);
  animation:slideUp .5s cubic-bezier(.34,1.56,.64,1);}
.done-stamp{
  display:inline-block;border:2.5px solid var(--green);color:var(--green);
  border-radius:7px;padding:.25rem .7rem;font-size:.82rem;font-weight:900;
  letter-spacing:.1em;transform:rotate(-2deg);margin-bottom:.6rem;}
.done-emoji{font-size:4.5rem;display:block;animation:pop .6s ease}
@keyframes pop{0%{transform:scale(0)}70%{transform:scale(1.2)}100%{transform:scale(1)}}
.done-title{font-size:1.7rem;font-weight:900;color:var(--green);margin:.35rem 0}
.done-pts{font-size:2.4rem;font-weight:900;color:#fbbf24;
  text-shadow:0 0 20px rgba(251,191,36,.4);margin:.3rem 0}
.done-stats{display:grid;grid-template-columns:repeat(4,1fr);gap:.45rem;margin:.7rem 0}
@media(max-width:560px){.done-stats{grid-template-columns:1fr 1fr}}
.stat-box{background:rgba(255,255,255,.04);border-radius:10px;padding:.65rem;
  border:1px solid rgba(255,255,255,.06);}
.stat-lbl{font-size:.66rem;color:var(--muted);margin-bottom:.12rem}
.stat-val{font-size:1.12rem;font-weight:700;color:var(--paper)}
.done-btns{display:grid;gap:.48rem}
.btn-nxt{
  padding:.85rem;border-radius:12px;border:none;cursor:pointer;
  font-size:.9rem;font-weight:700;
  background:linear-gradient(90deg,#059669,#10b981);color:#fff;
  box-shadow:0 4px 18px rgba(16,185,129,.22);transition:.15s;}
.btn-nxt:hover{transform:scale(1.02)}
.btn-home{
  padding:.68rem;border-radius:12px;border:1px solid rgba(255,255,255,.1);
  background:transparent;color:var(--muted);font-size:.83rem;cursor:pointer;}
</style>
</head>
<body>
<div id="flash" class="flash"></div>
<!-- Lecture Overlay -->
<div id="lec-overlay" class="lec-overlay">
  <div class="lec-modal">
    <div class="lec-dots" id="lec-dots"></div>
    <div class="lec-badge" id="lec-badge">ê°œë…</div>
    <h2 class="lec-h" id="lec-h"></h2>
    <div class="lec-b" id="lec-b"></div>
    <div class="lec-canvas-wrap" id="lec-cwrap" style="display:none">
      <canvas id="lec-canvas" width="300" height="300"></canvas>
    </div>
    <div class="lec-formula" id="lec-formula" style="display:none">
      <div class="lec-fval" id="lec-fval"></div>
      <div class="lec-fnote" id="lec-fnote"></div>
    </div>
    <div class="lec-tip" id="lec-tip" style="display:none"></div>
    <div class="lec-nav">
      <button class="l-prev" id="l-prev" onclick="lecPrev()">â† ì´ì „</button>
      <button class="l-next" id="l-next" onclick="lecNext()">ë‹¤ìŒ â†’</button>
    </div>
  </div>
</div>

<!-- Explain Overlay -->
<div id="exp-overlay" class="exp-overlay" onclick="closeExp()">
  <div class="exp-modal" id="exp-modal" onclick="event.stopPropagation()">
    <span class="exp-icon" id="exp-icon"></span>
    <h2 class="exp-title" id="exp-title"></h2>
    <div class="exp-ans-box">
      <div class="exp-ans-lbl">ì •ë‹µ</div>
      <div class="exp-ans-val" id="exp-ans-val"></div>
    </div>
    <ul class="exp-steps" id="exp-steps"></ul>
    <button class="exp-btn" onclick="closeExp()">âœ“ ì•Œê² ìŠµë‹ˆë‹¤! ë‹¤ìŒ ë¬¸ì œ â†’</button>
  </div>
</div>

<!-- Hint Overlay -->
<div id="hint-overlay" class="hint-overlay" onclick="closeHint()">
  <div class="hint-modal" onclick="event.stopPropagation()">
    <div class="hint-title">ğŸ’¡ íŒíŠ¸</div>
    <div class="hint-body" id="hint-body"></div>
    <button class="hint-close" onclick="closeHint()">ë‹«ê¸°</button>
  </div>
</div>

<div class="wrap">

<!-- ===== TITLE ===== -->
<div id="sc-title" class="screen active">
  <div class="hdr">
    <span class="hdr-icon">ğŸ“ˆ</span>
    <div class="hdr-info">
      <div class="hdr-title">ê·¸ë˜í”„ íƒí—˜ëŒ€</div>
      <div class="hdr-sub">ì¢Œí‘œí‰ë©´ Â· ì •ë¹„ë¡€ Â· ë°˜ë¹„ë¡€ Â· ì¼ì°¨í•¨ìˆ˜ | ì˜í†µìˆ˜í•™ì—¬í–‰í•™ì›</div>
      <span class="hdr-score">â­ <span id="t-score">0</span>ì 
        <span id="t-mode" style="font-size:.78rem;color:#94a3b8;margin-left:.4rem">ğŸ“ ê°ê´€ì‹</span>
      </span>
    </div>
    <div class="hdr-toc">
      <div>ğŸ“ ì¢Œí‘œí‰ë©´</div><div>ğŸ“ ì •ë¹„ë¡€ y=ax</div>
      <div>ğŸŒ€ ë°˜ë¹„ë¡€ y=a/x</div><div>ğŸ“ ì¼ì°¨í•¨ìˆ˜</div><div>ğŸ”€ ë‘ ì§ì„ </div>
    </div>
  </div>
  <div class="sec-label">ì±•í„° ì„ íƒ</div>
  <div class="ch-grid" id="ch-grid"></div>
  <div style="text-align:center;margin-bottom:.5rem">
    <button class="reset-btn" onclick="resetSave()">ğŸ—‘ ê¸°ë¡ ì´ˆê¸°í™”</button>
  </div>
  <div style="text-align:center;font-size:.7rem;color:#1e3a5f">
    ì½¤ë³´ 3=Ã—2, 5=Ã—3, 10=Ã—5
  </div>
</div>

<!-- ===== QUIZ ===== -->
<div id="sc-quiz" class="screen">
  <div class="qhdr">
    <div class="q-pts">â­ <span id="q-score">0</span></div>
    <div class="combo-el c0" id="combo-el">ì½¤ë³´ Ã—1</div>
    <button class="home-btn" onclick="goHome()">ì±•í„° ì„ íƒ</button>
  </div>
  <div class="timer-wrap"><div class="timer-bar" id="timer-bar"></div></div>
  <div class="quiz-body">
    <div class="quiz-left">
      <div class="canvas-card">
        <div class="canvas-tag" id="canvas-tag"></div>
        <div class="canvas-qn" id="canvas-qn"></div>
        <canvas id="graph-canvas"></canvas>
        <div class="q-text" id="q-text"></div>
        <div class="hint-row">
          <button class="hint-btn" onclick="showHint()">ğŸ’¡ íŒíŠ¸</button>
        </div>
      </div>
      <div class="choices" id="choices"></div>
      <div class="q-ctr" id="q-ctr"></div>
    </div>
    <div class="concept-panel" id="concept-panel"></div>
  </div>
</div>

<!-- ===== DONE ===== -->
<div id="sc-done" class="screen">
  <div class="done-card">
    <div class="done-stamp">ì±•í„° ì™„ë£Œ!</div>
    <span class="done-emoji" id="done-emoji">ğŸ†</span>
    <div class="done-title" id="done-title">ì™„ë£Œ!</div>
    <div class="done-pts" id="done-pts">+0ì </div>
    <div class="done-stats">
      <div class="stat-box"><div class="stat-lbl">ì •ë‹µë¥ </div><div class="stat-val" id="d-acc">-</div></div>
      <div class="stat-box"><div class="stat-lbl">ìµœê³  ì½¤ë³´</div><div class="stat-val" id="d-combo">-</div></div>
      <div class="stat-box"><div class="stat-lbl">ì´ ì ìˆ˜</div><div class="stat-val" id="d-total">-</div></div>
      <div class="stat-box"><div class="stat-lbl">ëª¨ë“œ</div><div class="stat-val" id="d-mode">-</div></div>
    </div>
  </div>
  <div class="done-btns">
    <button class="btn-nxt" id="btn-nxt" onclick="nextChapter()"></button>
    <button class="btn-home" onclick="goHome()">ğŸ  ì±•í„° ì„ íƒìœ¼ë¡œ</button>
  </div>
</div>

</div><!-- /wrap -->

<script>
// =====================================================
// CANVAS DRAWING ENGINE
// =====================================================
const RANGE = 7; // -6 ~ 6

function initCanvas(canvas){
  const dpr = window.devicePixelRatio||1;
  const rect = canvas.getBoundingClientRect();
  const sz = Math.min(rect.width||460, 460);
  canvas.width = sz * dpr;
  canvas.height = sz * dpr;
  const ctx = canvas.getContext('2d');
  ctx.scale(dpr, dpr);
  canvas.style.width = sz+'px';
  canvas.style.height = sz+'px';
  return {ctx, sz};
}

function drawScene(canvas, cfg){
  const dpr = window.devicePixelRatio||1;
  const W = canvas.width/dpr, H = canvas.height/dpr;
  const ctx = canvas.getContext('2d');
  const sc = W / (RANGE*2);
  const ox = W/2, oy = H/2;
  const px = x => ox + x*sc;
  const py = y => oy - y*sc;

  // BG
  ctx.fillStyle='#060e1c';
  ctx.fillRect(0,0,W,H);

  // Grid
  ctx.strokeStyle='rgba(56,189,248,0.08)';
  ctx.lineWidth=0.8;
  for(let i=-RANGE;i<=RANGE;i++){
    if(i===0)continue;
    ctx.beginPath();ctx.moveTo(px(i),0);ctx.lineTo(px(i),H);ctx.stroke();
    ctx.beginPath();ctx.moveTo(0,py(i));ctx.lineTo(W,py(i));ctx.stroke();
  }
  // Axes
  ctx.strokeStyle='rgba(56,189,248,0.65)';ctx.lineWidth=1.8;
  ctx.beginPath();ctx.moveTo(0,oy);ctx.lineTo(W,oy);ctx.stroke();
  ctx.beginPath();ctx.moveTo(ox,0);ctx.lineTo(ox,H);ctx.stroke();
  // Arrows
  ctx.fillStyle='rgba(56,189,248,0.65)';
  ctx.beginPath();ctx.moveTo(W-3,oy);ctx.lineTo(W-11,oy-5);ctx.lineTo(W-11,oy+5);ctx.fill();
  ctx.beginPath();ctx.moveTo(ox,3);ctx.lineTo(ox-5,11);ctx.lineTo(ox+5,11);ctx.fill();
  // Axis labels
  ctx.fillStyle='rgba(56,189,248,0.55)';ctx.font=`${Math.max(10,sc*0.35)}px sans-serif`;
  ctx.textAlign='center';
  for(let i=-6;i<=6;i++){
    if(i===0)continue;
    if(Math.abs(px(i)-ox)>8){
      ctx.fillText(i,px(i),oy+14);
    }
    ctx.textAlign='right';
    if(Math.abs(py(i)-oy)>8)ctx.fillText(i,ox-5,py(i)+4);
    ctx.textAlign='center';
  }
  ctx.fillStyle='rgba(148,163,184,0.5)';ctx.font=`${Math.max(11,sc*0.38)}px sans-serif`;
  ctx.textAlign='left';ctx.fillText('x',W-8,oy-7);
  ctx.fillText('y',ox+7,12);
  ctx.textAlign='right';ctx.fillText('O',ox-5,oy+13);

  // Shaded regions
  if(cfg.shade){
    cfg.shade.forEach(s=>{
      ctx.fillStyle=s.color||'rgba(56,189,248,0.05)';
      if(s.type==='quad'){
        const [qx1,qy1,qx2,qy2]=[s.x1,s.y1,s.x2,s.y2];
        ctx.fillRect(px(Math.min(qx1,qx2)),py(Math.max(qy1,qy2)),
          Math.abs(qx2-qx1)*sc,Math.abs(qy2-qy1)*sc);
      }
    });
  }

  // Lines y = mx + b
  if(cfg.lines){
    cfg.lines.forEach(line=>{
      ctx.strokeStyle=line.color||'#34d399';
      ctx.lineWidth=2.8;
      ctx.beginPath();
      let started=false;
      for(let xi=-RANGE;xi<=RANGE;xi+=0.05){
        const yi=line.m*xi+(line.b||0);
        if(Math.abs(yi)>RANGE*1.2)continue;
        const ppx=px(xi),ppy=py(yi);
        if(!started){ctx.moveTo(ppx,ppy);started=true;}
        else ctx.lineTo(ppx,ppy);
      }
      ctx.stroke();
      // label
      if(line.label){
        const lx=4, ly=line.m*lx+(line.b||0);
        if(Math.abs(ly)<RANGE-0.5){
          ctx.fillStyle=line.color||'#34d399';
          ctx.font=`bold ${Math.max(11,sc*0.38)}px sans-serif`;
          ctx.textAlign='left';
          ctx.fillText(line.label,px(lx)+6,py(ly)-6);
        }
      }
    });
  }

  // Inverse y = a/x
  if(cfg.inverses){
    cfg.inverses.forEach(inv=>{
      ctx.strokeStyle=inv.color||'#f59e0b';
      ctx.lineWidth=2.5;
      for(const sign of [1,-1]){
        ctx.beginPath();let first=true;
        for(let xi=0.15;xi<=RANGE;xi+=0.04){
          const x=sign*xi, y=inv.a/x;
          if(Math.abs(y)>RANGE*1.3)continue;
          if(first){ctx.moveTo(px(x),py(y));first=false;}
          else ctx.lineTo(px(x),py(y));
        }
        ctx.stroke();
      }
      if(inv.label){
        const lx=inv.a>0?3:-3, ly=inv.a/lx;
        if(Math.abs(ly)<RANGE-0.5){
          ctx.fillStyle=inv.color||'#f59e0b';
          ctx.font=`bold ${Math.max(11,sc*0.38)}px sans-serif`;
          ctx.textAlign='left';
          ctx.fillText(inv.label,px(lx)+6,py(ly)-6);
        }
      }
    });
  }

  // Points
  if(cfg.pts){
    cfg.pts.forEach(pt=>{
      const ppx=px(pt.x),ppy=py(pt.y);
      const r=sc*0.18;
      // glow
      const grd=ctx.createRadialGradient(ppx,ppy,0,ppx,ppy,r*3.5);
      grd.addColorStop(0,(pt.col||'#fbbf24')+'88');grd.addColorStop(1,'transparent');
      ctx.fillStyle=grd;ctx.beginPath();ctx.arc(ppx,ppy,r*3.5,0,Math.PI*2);ctx.fill();
      // dot
      ctx.fillStyle=pt.col||'#fbbf24';
      ctx.beginPath();ctx.arc(ppx,ppy,r,0,Math.PI*2);ctx.fill();
      // cross lines
      if(pt.cross){
        ctx.strokeStyle=(pt.col||'#fbbf24')+'44';ctx.lineWidth=1;ctx.setLineDash([3,3]);
        ctx.beginPath();ctx.moveTo(ppx,ppy);ctx.lineTo(ppx,oy);ctx.stroke();
        ctx.beginPath();ctx.moveTo(ppx,ppy);ctx.lineTo(ox,ppy);ctx.stroke();
        ctx.setLineDash([]);
      }
      // label
      if(pt.lbl){
        ctx.fillStyle=pt.col||'#fbbf24';
        ctx.font=`bold ${Math.max(12,sc*0.42)}px sans-serif`;
        ctx.textAlign='center';
        const off=r*2+4;
        ctx.fillText(pt.lbl,ppx+(pt.lx||0)*sc,ppy-(pt.ly||0)*sc-off);
      }
    });
  }

  // Mystery "?" question mark in center for quadrant questions
  if(cfg.qmark){
    ctx.fillStyle='rgba(167,139,250,0.15)';
    ctx.font=`bold ${W*0.28}px sans-serif`;
    ctx.textAlign='center';
    ctx.fillText('?',px(cfg.qmark.x),py(cfg.qmark.y)+W*0.1);
  }
}

function drawLecCanvas(canvas, cfg){
  const W=canvas.width, H=canvas.height;
  drawScene(canvas,cfg);
}

// =====================================================
// LECTURE DATA
// =====================================================
const LECS = [
  // ch0: ì¢Œí‘œí‰ë©´
  [
    {badge:'ì¢Œí‘œí‰ë©´ 1',h:'ì¢Œí‘œí‰ë©´ì´ë€?',
     b:`<strong>xì¶•(ê°€ë¡œ)</strong>ê³¼ <strong>yì¶•(ì„¸ë¡œ)</strong>ì´ ë§Œë‚˜ëŠ” <strong>ì›ì  O(0,0)</strong>ì„ ê¸°ì¤€ìœ¼ë¡œ í‰ë©´ì„ ë‚˜íƒ€ë‚´ìš”.<br><br>
     ì  Aì˜ ìœ„ì¹˜ëŠ” <strong>(xì¢Œí‘œ, yì¢Œí‘œ)</strong> ìˆœì„œë¡œ ì”ë‹ˆë‹¤.`,
     lcfg:{pts:[{x:3,y:2,col:'#38bdf8',lbl:'A(3,2)',cross:true}]},
     formula:'A(x, y) â†’ x: ì˜¤ë¥¸ìª½(+), ì™¼ìª½(âˆ’) / y: ìœ„(+), ì•„ë˜(âˆ’)',
     tip:'ìˆœì„œê°€ ì¤‘ìš”! (3,2)ì™€ (2,3)ì€ ë‹¤ë¥¸ ì ì´ì—ìš”.'},
    {badge:'ì¢Œí‘œí‰ë©´ 2',h:'ì‚¬ë¶„ë©´',
     b:`ì¶•ì„ ê¸°ì¤€ìœ¼ë¡œ í‰ë©´ì€ <strong>4ê°œ ì˜ì—­(ì‚¬ë¶„ë©´)</strong>ìœ¼ë¡œ ë‚˜ë‰©ë‹ˆë‹¤.<br><br>
     1ì‚¬ë¶„ë©´: x>0, y>0 &nbsp;|&nbsp; 2ì‚¬ë¶„ë©´: x<0, y>0<br>
     3ì‚¬ë¶„ë©´: x<0, y<0 &nbsp;|&nbsp; 4ì‚¬ë¶„ë©´: x>0, y<0`,
     lcfg:{
       shade:[
         {type:'quad',x1:0,y1:0,x2:6,y2:6,color:'rgba(52,211,153,0.08)'},
         {type:'quad',x1:-6,y1:0,x2:0,y2:6,color:'rgba(56,189,248,0.08)'},
         {type:'quad',x1:-6,y1:-6,x2:0,y2:0,color:'rgba(167,139,250,0.08)'},
         {type:'quad',x1:0,y1:-6,x2:6,y2:0,color:'rgba(245,158,11,0.08)'},
       ],
       pts:[
         {x:3,y:3,col:'#34d399',lbl:'1ì‚¬ë¶„ë©´'},
         {x:-3,y:3,col:'#38bdf8',lbl:'2ì‚¬ë¶„ë©´'},
         {x:-3,y:-3,col:'#a78bfa',lbl:'3ì‚¬ë¶„ë©´'},
         {x:3,y:-3,col:'#f59e0b',lbl:'4ì‚¬ë¶„ë©´'},
       ]
     },
     tip:'ì¶• ìœ„ì˜ ì (y=0 ë˜ëŠ” x=0)ì€ ì–´ëŠ ì‚¬ë¶„ë©´ì—ë„ ì†í•˜ì§€ ì•Šì•„ìš”!'},
  ],
  // ch1: ì •ë¹„ë¡€
  [
    {badge:'ì •ë¹„ë¡€ 1',h:'ì •ë¹„ë¡€ ê´€ê³„ y=ax',
     b:`xê°€ 2ë°°, 3ë°°ê°€ ë˜ë©´ yë„ <strong>2ë°°, 3ë°°</strong>ê°€ ë˜ëŠ” ê´€ê³„.<br><br>
     <strong>y = ax</strong> (a â‰  0) í˜•íƒœ. ê·¸ë˜í”„ëŠ” <strong>ì›ì ì„ ì§€ë‚˜ëŠ” ì§ì„ </strong>!`,
     lcfg:{lines:[{m:2,b:0,col:'#34d399',label:'y=2x'},{m:-1,b:0,col:'#f59e0b',label:'y=-x'}]},
     formula:'y = ax  (a = ê¸°ìš¸ê¸°, ì›ì  í†µê³¼)',
     tip:'a>0ì´ë©´ ìš°ìƒí–¥ â†—, a<0ì´ë©´ ìš°í•˜í–¥ â†˜'},
    {badge:'ì •ë¹„ë¡€ 2',h:'aê°’ êµ¬í•˜ê¸°',
     b:`ê·¸ë˜í”„ê°€ ì  (xâ‚€, yâ‚€)ì„ ì§€ë‚  ë•Œ:<br><br>
     <strong>a = yâ‚€ Ã· xâ‚€</strong><br><br>
     ì˜ˆ) (2, 6)ì„ ì§€ë‚œë‹¤ë©´ a = 6 Ã· 2 = <strong>3</strong>`,
     lcfg:{lines:[{m:3,b:0,col:'#34d399',label:'y=3x'}],pts:[{x:2,y:6,col:'#fbbf24',lbl:'(2,6)',cross:true}]},
     formula:'a = y Ã· x  (ì •ë¹„ë¡€ì—ì„œ í•­ìƒ ì„±ë¦½)',
     tip:'ì •ë¹„ë¡€ ê·¸ë˜í”„ì—ì„œ ì–´ëŠ ì ì„ ê³¨ë¼ë„ y/x = aë¡œ ê°™ì•„ìš”!'},
  ],
  // ch2: ë°˜ë¹„ë¡€
  [
    {badge:'ë°˜ë¹„ë¡€ 1',h:'ë°˜ë¹„ë¡€ ê´€ê³„ y=a/x',
     b:`xê°€ 2ë°°ì´ë©´ yëŠ” <strong>1/2ë°°</strong>ê°€ ë˜ëŠ” ê´€ê³„.<br><br>
     <strong>y = a/x</strong> (a â‰  0). ê·¸ë˜í”„ëŠ” <strong>ìŒê³¡ì„ </strong> â€” ë‘ ê³¡ì„ !`,
     lcfg:{inverses:[{a:6,col:'#38bdf8',label:'y=6/x'},{a:-6,col:'#f59e0b',label:'y=-6/x'}]},
     formula:'y = a/x  â†’  xy = a (í•­ìƒ ì¼ì •)',
     tip:'x, yì˜ ê³±(xy)ì´ í•­ìƒ ê°™ë‹¤ â†’ ì´ê²ƒì´ ë°˜ë¹„ë¡€ì˜ í•µì‹¬!'},
  ],
  // ch3: ì¼ì°¨í•¨ìˆ˜
  [
    {badge:'ì¼ì°¨í•¨ìˆ˜ 1',h:'ì¼ì°¨í•¨ìˆ˜ y=mx+b',
     b:`<strong>ê¸°ìš¸ê¸° m</strong>: ì§ì„ ì˜ ê¸°ìš¸ê¸° (xê°€ 1 ì¦ê°€í•  ë•Œ yì˜ ë³€í™”ëŸ‰)<br>
     <strong>yì ˆí¸ b</strong>: x=0ì¼ ë•Œì˜ yê°’ (ì§ì„ ì´ yì¶•ì„ ì§€ë‚˜ëŠ” ì )<br><br>
     ê·¸ë˜í”„: xì ˆí¸ = <strong>-b/m</strong>`,
     lcfg:{lines:[{m:2,b:-3,col:'#34d399',label:'y=2x-3'}],pts:[{x:0,y:-3,col:'#fbbf24',lbl:'(0,-3)',cross:true}]},
     formula:'ê¸°ìš¸ê¸° m = (yâ‚‚-yâ‚)Ã·(xâ‚‚-xâ‚)',
     tip:'í‰í–‰í•œ ë‘ ì§ì„ ì˜ ê¸°ìš¸ê¸°ëŠ” ê°™ê³ , yì ˆí¸ë§Œ ë‹¬ë¼ìš”!'},
    {badge:'ì¼ì°¨í•¨ìˆ˜ 2',h:'ë‘ ì ìœ¼ë¡œ ì‹ êµ¬í•˜ê¸°',
     b:`ë‘ ì  (xâ‚,yâ‚), (xâ‚‚,yâ‚‚)ë¥¼ ì§€ë‚  ë•Œ:<br><br>
     â‘  ê¸°ìš¸ê¸° <strong>m = (yâ‚‚-yâ‚)Ã·(xâ‚‚-xâ‚)</strong><br>
     â‘¡ <strong>y = mx + b</strong>ì— í•œ ì  ëŒ€ì… â†’ b ê³„ì‚°`,
     lcfg:{
       lines:[{m:2,b:1,col:'#38bdf8',label:'y=2x+1'}],
       pts:[{x:0,y:1,col:'#34d399',lbl:'(0,1)'},{x:2,y:5,col:'#f59e0b',lbl:'(2,5)'}]
     },
     formula:'m = (5-1)Ã·(2-0) = 2  â†’  y=2x+1',
     tip:'ë‘ ì ì´ ì£¼ì–´ì§€ë©´ ê¸°ìš¸ê¸° ë¨¼ì €, ê·¸ ë‹¤ìŒ yì ˆí¸ ìˆœì„œ!'},
  ],
  // ch4: ë‘ ì§ì„ 
  [
    {badge:'ë‘ ì§ì„  1',h:'êµì ê³¼ ì—°ë¦½ë°©ì •ì‹',
     b:`ë‘ ì§ì„ ì˜ <strong>êµì </strong>ì€ ë‘ ë°©ì •ì‹ì„ ë™ì‹œì— ë§Œì¡±í•˜ëŠ” ì .<br><br>
     ì—°ë¦½ë°©ì •ì‹ìœ¼ë¡œ í’€ë©´ ë©ë‹ˆë‹¤:<br>
     y=x+1ê³¼ y=-x+3 â†’ x+1=-x+3 â†’ 2x=2 â†’ x=1, y=2`,
     lcfg:{
       lines:[{m:1,b:1,col:'#34d399',label:'y=x+1'},{m:-1,b:3,col:'#f59e0b',label:'y=-x+3'}],
       pts:[{x:1,y:2,col:'#fbbf24',lbl:'êµì (1,2)',cross:true}]
     },
     formula:'êµì  â†’ ë‘ ì‹ì„ ì—°ë¦½: y=yë¡œ ë†“ê³  x ë¨¼ì €!',
     tip:'ê¸°ìš¸ê¸°ê°€ ê°™ì€ ë‘ ì§ì„ ì€ í‰í–‰ â†’ êµì  ì—†ìŒ!'},
  ],
];

// =====================================================
// CONCEPT PANEL DATA
// =====================================================
const CONCEPTS=[
  {title:'ğŸ“ ì¢Œí‘œí‰ë©´',
   formulas:[
     {lbl:'ì¢Œí‘œ',val:'ì  A(x, y) â€” ê°€ë¡œ x, ì„¸ë¡œ y'},
     {lbl:'1ì‚¬ë¶„ë©´',val:'x>0, y>0  (ìš°ìƒ)'},
     {lbl:'2ì‚¬ë¶„ë©´',val:'x<0, y>0  (ì¢Œìƒ)'},
     {lbl:'3ì‚¬ë¶„ë©´',val:'x<0, y<0  (ì¢Œí•˜)'},
     {lbl:'4ì‚¬ë¶„ë©´',val:'x>0, y<0  (ìš°í•˜)'},
   ],
   whys:[
     {q:'â“ ì™œ ìˆœì„œê°€ ì¤‘ìš”í•œê°€?',
      a:'(3,2)ëŠ” ì˜¤ë¥¸ìª½ 3ì¹¸, ìœ„ 2ì¹¸. (2,3)ì€ ì˜¤ë¥¸ìª½ 2ì¹¸, ìœ„ 3ì¹¸. <strong>ì™„ì „íˆ ë‹¤ë¥¸ ì !</strong>'},
     {q:'â“ ì¶• ìœ„ì˜ ì ì€ ëª‡ ì‚¬ë¶„ë©´?',
      a:'<strong>ì–´ëŠ ì‚¬ë¶„ë©´ì—ë„ ì†í•˜ì§€ ì•ŠìŒ.</strong> xì¶•(y=0)ì´ë‚˜ yì¶•(x=0) ìœ„ì˜ ì ì€ ê²½ê³„ì„  ìœ„ì— ìˆì–´ìš”'},
   ]},
  {title:'ğŸ“ ì •ë¹„ë¡€ y=ax',
   formulas:[
     {lbl:'ê¸°ë³¸ ì‹',val:'y = ax  (aâ‰ 0)'},
     {lbl:'íŠ¹ì§•',val:'ì›ì (0,0)ì„ ì§€ë‚˜ëŠ” ì§ì„ '},
     {lbl:'a êµ¬í•˜ê¸°',val:'a = y Ã· x (ì  ëŒ€ì…)'},
   ],
   whys:[
     {q:'â“ ì™œ ì›ì ì„ ì§€ë‚˜ë‚˜?',
      a:'x=0ì„ ëŒ€ì…í•˜ë©´ y=aÃ—0=0. <strong>í•­ìƒ (0,0)ì„ ì§€ë‚¨</strong>'},
     {q:'â“ aê°€ í´ìˆ˜ë¡?',
      a:'ê¸°ìš¸ê¸°ê°€ ê°€íŒ”ë¼ì§. <strong>|a|ê°€ í´ìˆ˜ë¡ yì¶•ì— ê°€ê¹Œìš´ ì§ì„ </strong>'},
     {q:'â“ ì •ë¹„ë¡€ ê´€ê³„ í™•ì¸ë²•?',
      a:'í‘œì—ì„œ <strong>yÃ·x ê°’ì´ í•­ìƒ ì¼ì •</strong>í•˜ë©´ ì •ë¹„ë¡€. ê·¸ ê°’ì´ a'},
   ]},
  {title:'ğŸŒ€ ë°˜ë¹„ë¡€ y=a/x',
   formulas:[
     {lbl:'ê¸°ë³¸ ì‹',val:'y = a/x  (aâ‰ 0)'},
     {lbl:'íŠ¹ì§•',val:'xy = a (ê³±ì´ í•­ìƒ ì¼ì •)'},
     {lbl:'a êµ¬í•˜ê¸°',val:'a = xy (ì  ëŒ€ì…)'},
   ],
   whys:[
     {q:'â“ ì™œ ìŒê³¡ì„ ì¸ê°€?',
      a:'xâ†’0ì´ë©´ yâ†’âˆ, xâ†’âˆì´ë©´ yâ†’0. <strong>ë‘ ê°œì˜ ê³¡ì„ </strong>ì´ ëŒ€ì¹­ìœ¼ë¡œ ìƒê¹€'},
     {q:'â“ a>0ì´ë©´ ëª‡ ì‚¬ë¶„ë©´?',
      a:'<strong>1, 3ì‚¬ë¶„ë©´</strong> (xì™€ y ë¶€í˜¸ê°€ ê°™ì„ ë•Œ ê³±ì´ ì–‘ìˆ˜)'},
     {q:'â“ a<0ì´ë©´ ëª‡ ì‚¬ë¶„ë©´?',
      a:'<strong>2, 4ì‚¬ë¶„ë©´</strong> (xì™€ y ë¶€í˜¸ê°€ ë°˜ëŒ€ì¼ ë•Œ ê³±ì´ ìŒìˆ˜)'},
   ]},
  {title:'ğŸ“ ì¼ì°¨í•¨ìˆ˜ y=mx+b',
   formulas:[
     {lbl:'ê¸°ë³¸ ì‹',val:'y = mx + b'},
     {lbl:'ê¸°ìš¸ê¸° m',val:'(yâ‚‚âˆ’yâ‚)Ã·(xâ‚‚âˆ’xâ‚)'},
     {lbl:'yì ˆí¸',val:'x=0ì¼ ë•Œì˜ yê°’ (b)'},
     {lbl:'xì ˆí¸',val:'y=0ìœ¼ë¡œ ë†“ê³  í’€ë©´ âˆ’b/m'},
   ],
   whys:[
     {q:'â“ ê¸°ìš¸ê¸°ëŠ” ë¬´ì—‡ì„ ëœ»í•˜ë‚˜?',
      a:'xê°€ 1 ì¦ê°€í•  ë•Œ yì˜ ë³€í™”ëŸ‰. <strong>m=2ì´ë©´ xê°€ 1 ëŠ˜ ë•Œ yê°€ 2 ì¦ê°€</strong>'},
     {q:'â“ ë‘ ì§ì„ ì´ í‰í–‰í•˜ë ¤ë©´?',
      a:'<strong>ê¸°ìš¸ê¸°(m)ê°€ ê°™ê³  yì ˆí¸(b)ì´ ë‹¬ë¼ì•¼ í•¨</strong>. ê¸°ìš¸ê¸°ê°€ ê°™ìœ¼ë©´ ë§Œë‚˜ì§€ ì•ŠìŒ'},
   ]},
  {title:'ğŸ”€ ë‘ ì§ì„ ì˜ êµì ',
   formulas:[
     {lbl:'êµì ',val:'ë‘ ì§ì„ ì´ ë§Œë‚˜ëŠ” ì '},
     {lbl:'í’€ì´ë²•',val:'y=yë¡œ ë†“ê³  ì—°ë¦½'},
     {lbl:'í‰í–‰',val:'ê¸°ìš¸ê¸° ê°™ìŒ â†’ êµì  ì—†ìŒ'},
   ],
   whys:[
     {q:'â“ ì™œ y=yë¡œ ë†“ë‚˜?',
      a:'êµì ì—ì„œëŠ” <strong>ë‘ yê°’ì´ ê°™ìœ¼ë¯€ë¡œ</strong> ë“±ì¹˜ë¡œ ë†“ì•„ xë¥¼ ë¨¼ì € êµ¬í•¨'},
     {q:'â“ êµì ì´ ë¬´í•œíˆ ë§ìœ¼ë©´?',
      a:'ë‘ ì§ì„ ì´ <strong>ì™„ì „íˆ ê°™ì€ ì§ì„ </strong>. ê¸°ìš¸ê¸°ì™€ yì ˆí¸ ëª¨ë‘ ê°™ì„ ë•Œ'},
   ]},
];

// =====================================================
// QUESTION DATA
// =====================================================
const CH_META=[
  {emoji:'ğŸ“',title:'ì¢Œí‘œí‰ë©´',sub:'ì¢Œí‘œÂ·ì‚¬ë¶„ë©´'},
  {emoji:'ğŸ“',title:'ì •ë¹„ë¡€',sub:'y = ax'},
  {emoji:'ğŸŒ€',title:'ë°˜ë¹„ë¡€',sub:'y = a/x'},
  {emoji:'ğŸ“',title:'ì¼ì°¨í•¨ìˆ˜',sub:'y = mx+b'},
  {emoji:'ğŸ”€',title:'ë‘ ì§ì„ ',sub:'êµì Â·ì—°ë¦½'},
];

const QS=[
  // CH0: ì¢Œí‘œí‰ë©´
  [
    {q:'ê·¸ë˜í”„ì—ì„œ ì  Aì˜ ì¢Œí‘œëŠ”?',
     cfg:{pts:[{x:3,y:2,col:'#38bdf8',lbl:'A',cross:true}]},
     c:['(2,3)','(3,2)','(-3,2)','(3,-2)'],ans:1,fill:'(3,2)',
     hint:'xì¢Œí‘œ(ê°€ë¡œ)ë¥¼ ë¨¼ì €, yì¢Œí‘œ(ì„¸ë¡œ)ë¥¼ ë‚˜ì¤‘ì— ì”ë‹ˆë‹¤.',
     st:['Aì—ì„œ xì¶• ë°©í–¥: <strong>ì˜¤ë¥¸ìª½ 3</strong>','yì¶• ë°©í–¥: <strong>ìœ„ 2</strong>','â†’ A = <strong>(3, 2)</strong>'],ans_txt:'(3,2)'},
    {q:'ì  B(-2, 4)ë¥¼ ì¢Œí‘œí‰ë©´ì— ë‚˜íƒ€ë‚¸ ì ì€?',
     cfg:{pts:[
       {x:-2,y:4,col:'#34d399',lbl:'ì •ë‹µ'},{x:2,y:4,col:'#f87171',lbl:'â‘ '},
       {x:-2,y:-4,col:'#f59e0b',lbl:'â‘¡'},{x:4,y:-2,col:'#a78bfa',lbl:'â‘¢'}
     ]},
     c:['â‘¡ í‘œì‹œ ì ','â‘¢ í‘œì‹œ ì ','â‘  í‘œì‹œ ì ','ì´ˆë¡ ì (ì •ë‹µ)'],ans:3,fill:'ì´ˆë¡',
     hint:'x=-2: yì¶• ì™¼ìª½ 2ì¹¸ / y=4: xì¶• ìœ„ 4ì¹¸',
     st:['xì¢Œí‘œ -2 â†’ <strong>ì™¼ìª½ 2ì¹¸</strong>','yì¢Œí‘œ 4 â†’ <strong>ìœ„ 4ì¹¸</strong>','â†’ B = <strong>(-2, 4)</strong>'],ans_txt:'ì´ˆë¡ ì (ì •ë‹µ)'},
    {q:'ì  P(2, -3)ì€ ëª‡ ì‚¬ë¶„ë©´ì— ìˆë‚˜?',
     cfg:{pts:[{x:2,y:-3,col:'#fbbf24',lbl:'P(2,-3)',cross:true}],
       shade:[{type:'quad',x1:0,y1:-6,x2:6,y2:0,color:'rgba(251,191,36,0.08)'}]},
     c:['1ì‚¬ë¶„ë©´','2ì‚¬ë¶„ë©´','3ì‚¬ë¶„ë©´','4ì‚¬ë¶„ë©´'],ans:3,fill:'4',
     hint:'x>0(ì˜¤ë¥¸ìª½), y<0(ì•„ë˜ìª½) â†’ ?ì‚¬ë¶„ë©´',
     st:['x=2>0: <strong>ì˜¤ë¥¸ìª½</strong>','y=-3<0: <strong>ì•„ë˜ìª½</strong>','ì˜¤ë¥¸ìª½+ì•„ë˜ = <strong>4ì‚¬ë¶„ë©´</strong>'],ans_txt:'4ì‚¬ë¶„ë©´'},
    {q:'ì  Q(-4, -2)ëŠ” ëª‡ ì‚¬ë¶„ë©´ì— ìˆë‚˜?',
     cfg:{pts:[{x:-4,y:-2,col:'#a78bfa',lbl:'Q',cross:true}],
       shade:[{type:'quad',x1:-6,y1:-6,x2:0,y2:0,color:'rgba(167,139,250,0.08)'}]},
     c:['1ì‚¬ë¶„ë©´','2ì‚¬ë¶„ë©´','3ì‚¬ë¶„ë©´','4ì‚¬ë¶„ë©´'],ans:2,fill:'3',
     hint:'x<0(ì™¼ìª½), y<0(ì•„ë˜ìª½) â†’ ?ì‚¬ë¶„ë©´',
     st:['x=-4<0: <strong>ì™¼ìª½</strong>','y=-2<0: <strong>ì•„ë˜ìª½</strong>','ì™¼ìª½+ì•„ë˜ = <strong>3ì‚¬ë¶„ë©´</strong>'],ans_txt:'3ì‚¬ë¶„ë©´'},
    {q:'xì¢Œí‘œê°€ ì–‘ìˆ˜, yì¢Œí‘œê°€ ìŒìˆ˜ì¸ ì ì€ ëª‡ ì‚¬ë¶„ë©´?',
     cfg:{shade:[{type:'quad',x1:0,y1:-6,x2:6,y2:0,color:'rgba(56,189,248,0.1)'}]},
     c:['1ì‚¬ë¶„ë©´','2ì‚¬ë¶„ë©´','3ì‚¬ë¶„ë©´','4ì‚¬ë¶„ë©´'],ans:3,fill:'4',
     hint:'x>0ì€ ì˜¤ë¥¸ìª½, y<0ì€ ì•„ë˜ìª½',
     st:['x>0 â†’ ì˜¤ë¥¸ìª½ ì˜ì—­','y<0 â†’ ì•„ë˜ìª½ ì˜ì—­','ë‘ ì¡°ê±´ ëª¨ë‘ â†’ <strong>4ì‚¬ë¶„ë©´</strong>'],ans_txt:'4ì‚¬ë¶„ë©´'},
    {q:'ì  A(3, a)ê°€ 2ì‚¬ë¶„ë©´ì— ìˆìœ¼ë ¤ë©´ aì˜ ì¡°ê±´ì€?',
     cfg:{shade:[{type:'quad',x1:-6,y1:0,x2:0,y2:6,color:'rgba(52,211,153,0.08)'}]},
     c:['a>0','a<0','a=0','ì•Œ ìˆ˜ ì—†ìŒ'],ans:1,fill:'a<0',
     hint:'2ì‚¬ë¶„ë©´: x<0, y>0 â€” ê·¸ëŸ°ë° x=3>0ì´ë©´?',
     st:['2ì‚¬ë¶„ë©´ ì¡°ê±´: x<0, y>0','ê·¸ëŸ°ë° x=3>0ì´ë¯€ë¡œ A(3,a)ëŠ” <strong>2ì‚¬ë¶„ë©´ ë¶ˆê°€!</strong>','ì‹¤ì œë¡œ a>0ì´ë©´ 1ì‚¬ë¶„ë©´, a<0ì´ë©´ 4ì‚¬ë¶„ë©´'],ans_txt:'ë¶ˆê°€ëŠ¥ (ì˜¤ë‹µ: a<0)'},
    {q:'xì¶• ìœ„ì˜ ì  (5, 0)ì€ ëª‡ ì‚¬ë¶„ë©´?',
     cfg:{pts:[{x:5,y:0,col:'#38bdf8',lbl:'(5,0)'}]},
     c:['1ì‚¬ë¶„ë©´','4ì‚¬ë¶„ë©´','xì¶• ìœ„ (ì‚¬ë¶„ë©´ ì•„ë‹˜)','ì›ì '],ans:2,fill:'ì‚¬ë¶„ë©´ ì•„ë‹˜',
     hint:'xì¶•(y=0)ì´ë‚˜ yì¶•(x=0) ìœ„ì˜ ì ì€ ì‚¬ë¶„ë©´ì— ì†í•˜ì§€ ì•Šì•„ìš”.',
     st:['y=0 â†’ xì¶• ìœ„ì— ìˆìŒ','ì¶• ìœ„ì˜ ì ì€ <strong>ì–´ëŠ ì‚¬ë¶„ë©´ì—ë„ ì†í•˜ì§€ ì•ŠìŒ</strong>'],ans_txt:'xì¶• ìœ„ (ì‚¬ë¶„ë©´ ì•„ë‹˜)'},
    {q:'ë‘ ì  A(a, 3), B(-2, b)ê°€ ê°ê° 1ì‚¬ë¶„ë©´, 3ì‚¬ë¶„ë©´ì— ìˆë‹¤. a, bì˜ ë¶€í˜¸ëŠ”?',
     cfg:{
       pts:[{x:3,y:3,col:'#34d399',lbl:'A'},{x:-2,y:-2,col:'#f87171',lbl:'B'}],
       shade:[
         {type:'quad',x1:0,y1:0,x2:6,y2:6,color:'rgba(52,211,153,0.07)'},
         {type:'quad',x1:-6,y1:-6,x2:0,y2:0,color:'rgba(248,113,113,0.07)'},
       ]
     },
     c:['a>0, b>0','a>0, b<0','a<0, b>0','a<0, b<0'],ans:1,fill:'a>0,b<0',
     hint:'1ì‚¬ë¶„ë©´: x>0, y>0 / 3ì‚¬ë¶„ë©´: x<0, y<0',
     st:['Aê°€ 1ì‚¬ë¶„ë©´ â†’ a>0 (xì¢Œí‘œ ì–‘ìˆ˜)','Bê°€ 3ì‚¬ë¶„ë©´ â†’ b<0 (yì¢Œí‘œ ìŒìˆ˜)','â†’ <strong>a>0, b<0</strong>'],ans_txt:'a>0, b<0'},
    {q:'ì  C(a, b)ê°€ 2ì‚¬ë¶„ë©´ì— ìˆì„ ë•Œ, ì  D(b, a)ëŠ” ëª‡ ì‚¬ë¶„ë©´?',
     cfg:{shade:[
       {type:'quad',x1:-6,y1:0,x2:0,y2:6,color:'rgba(56,189,248,0.08)'},
       {type:'quad',x1:0,y1:-6,x2:6,y2:0,color:'rgba(245,158,11,0.08)'},
     ]},
     c:['1ì‚¬ë¶„ë©´','2ì‚¬ë¶„ë©´','3ì‚¬ë¶„ë©´','4ì‚¬ë¶„ë©´'],ans:3,fill:'4',
     hint:'2ì‚¬ë¶„ë©´: a<0, b>0. D(b,a)ì—ì„œ xì¢Œí‘œ=b, yì¢Œí‘œ=a',
     st:['Cê°€ 2ì‚¬ë¶„ë©´ â†’ a<0, b>0','D(b,a): x=b>0, y=a<0','x>0, y<0 â†’ <strong>4ì‚¬ë¶„ë©´</strong>'],ans_txt:'4ì‚¬ë¶„ë©´'},
    {q:'ì›ì  O(0,0)ì€ ëª‡ ì‚¬ë¶„ë©´ì— ì†í•˜ë‚˜?',
     cfg:{pts:[{x:0,y:0,col:'#fbbf24',lbl:'O'}]},
     c:['1ì‚¬ë¶„ë©´','3ì‚¬ë¶„ë©´','ì–´ëŠ ì‚¬ë¶„ë©´ì—ë„ ì†í•˜ì§€ ì•ŠìŒ','ëª¨ë“  ì‚¬ë¶„ë©´'],ans:2,fill:'ì†í•˜ì§€ ì•ŠìŒ',
     hint:'ì›ì ì€ ë‘ ì¶•ì˜ êµì°¨ì ì…ë‹ˆë‹¤.',
     st:['ì›ì  OëŠ” xì¶•ê³¼ yì¶•ì´ ë§Œë‚˜ëŠ” ì ','<strong>ì–´ëŠ ì‚¬ë¶„ë©´ì—ë„ ì†í•˜ì§€ ì•ŠìŒ</strong>','(ì‚¬ë¶„ë©´ ê²½ê³„ = ë‘ ì¶•)'],ans_txt:'ì–´ëŠ ì‚¬ë¶„ë©´ì—ë„ ì†í•˜ì§€ ì•ŠìŒ'},
  ],
  // CH1: ì •ë¹„ë¡€
  [
    {q:'ì´ ê·¸ë˜í”„ì˜ aê°’ì€? (y = ax)',
     cfg:{lines:[{m:2,b:0,col:'#34d399',label:'y=ax'}],pts:[{x:1,y:2,col:'#fbbf24',lbl:'(1,2)',cross:true}]},
     c:['a=1','a=2','a=3','a=-2'],ans:1,fill:'2',
     hint:'ì •ë¹„ë¡€: a = y Ã· x. ì  (1,2)ë¥¼ ì´ìš©í•˜ì„¸ìš”.',
     st:['ì  (1,2)ê°€ ê·¸ë˜í”„ ìœ„ì— ìˆìŒ','a = y Ã· x = 2 Ã· 1','= <strong>2</strong>'],ans_txt:'a=2'},
    {q:'ê·¸ë˜í”„ê°€ ì  (3, 9)ë¥¼ ì§€ë‚œë‹¤. aê°’ì€?',
     cfg:{lines:[{m:3,b:0,col:'#38bdf8'}],pts:[{x:3,y:9,col:'#fbbf24',lbl:'(3,9)',cross:true}]},
     c:['a=2','a=3','a=4','a=6'],ans:1,fill:'3',
     hint:'a = y Ã· x',
     st:['ì  (3,9)ì´ y=ax ìœ„','a = 9 Ã· 3','= <strong>3</strong>'],ans_txt:'a=3'},
    {q:'y = -2x ê·¸ë˜í”„ì˜ íŠ¹ì§•ìœ¼ë¡œ ì˜³ì€ ê²ƒì€?',
     cfg:{lines:[{m:-2,b:0,col:'#f59e0b',label:'y=-2x'}]},
     c:['ì›ì ì„ ì§€ë‚˜ê³  ìš°ìƒí–¥','ì›ì ì„ ì§€ë‚˜ê³  ìš°í•˜í–¥','yì ˆí¸ì´ -2','xì¶•ê³¼ í‰í–‰'],ans:1,fill:'ìš°í•˜í–¥',
     hint:'a<0ì´ë©´ ê·¸ë˜í”„ëŠ” ì–´ëŠ ë°©í–¥?',
     st:['y=-2x: a=-2<0','a<0 â†’ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°ˆìˆ˜ë¡ y ê°ì†Œ','â†’ <strong>ì›ì ì„ ì§€ë‚˜ê³  ìš°í•˜í–¥</strong>'],ans_txt:'ì›ì ì„ ì§€ë‚˜ê³  ìš°í•˜í–¥'},
    {q:'y = axì—ì„œ x=4ì¼ ë•Œ y=12ì´ë‹¤. aê°’ì€?',
     cfg:{lines:[{m:3,b:0,col:'#a78bfa'}],pts:[{x:4,y:12,col:'#fbbf24',lbl:'(4,12)',cross:true}]},
     c:['a=2','a=3','a=4','a=8'],ans:1,fill:'3',
     hint:'12 = a Ã— 4 â†’ a = ?',
     st:['y=axì—ì„œ x=4, y=12 ëŒ€ì…','12 = a Ã— 4','a = 12 Ã· 4 = <strong>3</strong>'],ans_txt:'a=3'},
    {q:'ì •ë¹„ë¡€ ê´€ê³„ y = (1/2)x ì—ì„œ x=6ì¼ ë•Œ yëŠ”?',
     cfg:{lines:[{m:0.5,b:0,col:'#34d399',label:'y=x/2'}],pts:[{x:6,y:3,col:'#fbbf24',lbl:'?',cross:true}]},
     c:['y=2','y=3','y=4','y=12'],ans:1,fill:'3',
     hint:'y = (1/2) Ã— 6',
     st:['y = (1/2) Ã— 6','= <strong>3</strong>'],ans_txt:'y=3'},
    {q:'ë‘ ì •ë¹„ë¡€ y=2xì™€ y=5x ì¤‘ ë” ê°€íŒŒë¥¸ ê·¸ë˜í”„ëŠ”?',
     cfg:{lines:[{m:2,b:0,col:'#34d399',label:'y=2x'},{m:5,b:0,col:'#f87171',label:'y=5x'}]},
     c:['y=2x','y=5x','ê°™ë‹¤','ì•Œ ìˆ˜ ì—†ë‹¤'],ans:1,fill:'y=5x',
     hint:'|a|ê°’ì´ í´ìˆ˜ë¡ ê¸°ìš¸ê¸°ê°€ ê°€íŒŒë¦…ë‹ˆë‹¤.',
     st:['y=2x: |a|=2','y=5x: |a|=5','|5|>|2| â†’ <strong>y=5xê°€ ë” ê°€íŒŒë¦„</strong>'],ans_txt:'y=5x'},
    {q:'y = axì—ì„œ xê°€ 3ë°°ê°€ ë˜ë©´ yëŠ” ëª‡ ë°°?',
     cfg:{lines:[{m:2,b:0,col:'#38bdf8'}],pts:[{x:1,y:2,col:'#fbbf24',lbl:'x'},{x:3,y:6,col:'#34d399',lbl:'3x'}]},
     c:['ë³€í•˜ì§€ ì•ŠìŒ','2ë°°','3ë°°','9ë°°'],ans:2,fill:'3ë°°',
     hint:'ì •ë¹„ë¡€: xê°€ kë°°ì´ë©´ yë„ kë°°!',
     st:['y=ax: yëŠ” xì— ë¹„ë¡€','x â†’ 3xì´ë©´','y â†’ aÃ—3x = <strong>3ë°°</strong>'],ans_txt:'3ë°°'},
    {q:'y = axê°€ ì  (-2, 6)ì„ ì§€ë‚  ë•Œ aëŠ”?',
     cfg:{lines:[{m:-3,b:0,col:'#f59e0b',label:'y=ax'}],pts:[{x:-2,y:6,col:'#fbbf24',lbl:'(-2,6)',cross:true}]},
     c:['a=3','a=-3','a=1/3','a=-1/3'],ans:1,fill:'-3',
     hint:'a = y Ã· x = 6 Ã· (-2)',
     st:['a = y Ã· x','= 6 Ã· (-2)','= <strong>-3</strong>'],ans_txt:'a=-3'},
    {q:'ì •ë¹„ë¡€ y=3xì—ì„œ x=-4ì¼ ë•Œ yëŠ”?',
     cfg:{lines:[{m:3,b:0,col:'#a78bfa'}],pts:[{x:-4,y:-12,col:'#fbbf24',lbl:'(-4,?)',cross:true}]},
     c:['y=12','y=-12','y=-7','y=7'],ans:1,fill:'-12',
     hint:'y = 3 Ã— (-4)',
     st:['y = 3 Ã— (-4)','= <strong>-12</strong>'],ans_txt:'y=-12'},
    {q:'y = axì—ì„œ a = 1/3ì´ë‹¤. x=9ì¼ ë•Œ yëŠ”?',
     cfg:{lines:[{m:1/3,b:0,col:'#34d399',label:'y=(1/3)x'}],pts:[{x:9,y:3,col:'#fbbf24',lbl:'(9,?)',cross:true}]},
     c:['y=1','y=2','y=3','y=27'],ans:2,fill:'3',
     hint:'y = (1/3) Ã— 9',
     st:['y = (1/3) Ã— 9','= 9/3','= <strong>3</strong>'],ans_txt:'y=3'},
  ],
  // CH2: ë°˜ë¹„ë¡€
  [
    {q:'ê·¸ë˜í”„ì˜ aê°’ì€? (y = a/x)',
     cfg:{inverses:[{a:6,col:'#38bdf8',label:'y=a/x'}],pts:[{x:2,y:3,col:'#fbbf24',lbl:'(2,3)',cross:true}]},
     c:['a=2','a=3','a=6','a=12'],ans:2,fill:'6',
     hint:'a = x Ã— y = 2 Ã— 3',
     st:['a = x Ã— y','= 2 Ã— 3','= <strong>6</strong>'],ans_txt:'a=6'},
    {q:'y = 12/xì—ì„œ x=3ì¼ ë•Œ yëŠ”?',
     cfg:{inverses:[{a:12,col:'#34d399'}],pts:[{x:3,y:4,col:'#fbbf24',lbl:'(3,?)',cross:true}]},
     c:['y=3','y=4','y=6','y=36'],ans:1,fill:'4',
     hint:'y = 12 Ã· 3',
     st:['y = 12/3','= <strong>4</strong>'],ans_txt:'y=4'},
    {q:'y = -6/xì˜ ê·¸ë˜í”„ëŠ” ëª‡ ì‚¬ë¶„ë©´ì— ìˆë‚˜?',
     cfg:{inverses:[{a:-6,col:'#f59e0b',label:'y=-6/x'}]},
     c:['1, 3ì‚¬ë¶„ë©´','2, 4ì‚¬ë¶„ë©´','1, 2ì‚¬ë¶„ë©´','3, 4ì‚¬ë¶„ë©´'],ans:1,fill:'2,4',
     hint:'a<0ì´ë©´ ìŒê³¡ì„ ì€ 2, 4ì‚¬ë¶„ë©´ì— ìœ„ì¹˜',
     st:['a=-6<0','a<0ì¸ ë°˜ë¹„ë¡€ëŠ” <strong>2, 4ì‚¬ë¶„ë©´</strong>ì— ìœ„ì¹˜','(xì™€ y ë¶€í˜¸ê°€ ë°˜ëŒ€)'],ans_txt:'2, 4ì‚¬ë¶„ë©´'},
    {q:'y = a/xì—ì„œ ì  (3, -4)ê°€ ê·¸ë˜í”„ ìœ„ì— ìˆë‹¤. aëŠ”?',
     cfg:{inverses:[{a:-12,col:'#a78bfa'}],pts:[{x:3,y:-4,col:'#fbbf24',lbl:'(3,-4)',cross:true}]},
     c:['a=7','a=-7','a=12','a=-12'],ans:3,fill:'-12',
     hint:'a = x Ã— y = 3 Ã— (-4)',
     st:['a = x Ã— y','= 3 Ã— (-4)','= <strong>-12</strong>'],ans_txt:'a=-12'},
    {q:'y = 8/xì—ì„œ xyì˜ ê°’ì€?',
     cfg:{inverses:[{a:8,col:'#34d399'}]},
     c:['xë§ˆë‹¤ ë‹¤ë¦„','í•­ìƒ 4','í•­ìƒ 8','í•­ìƒ 16'],ans:2,fill:'8',
     hint:'ë°˜ë¹„ë¡€ì—ì„œ xyëŠ” í•­ìƒ a!',
     st:['y = 8/x ì–‘ë³€ì— xë¥¼ ê³±í•˜ë©´','xy = 8','â†’ xì™€ yì˜ ê³±ì€ í•­ìƒ <strong>8</strong>'],ans_txt:'í•­ìƒ 8'},
    {q:'ë°˜ë¹„ë¡€ y = 4/xì—ì„œ xê°€ 2ë°°ê°€ ë˜ë©´ yëŠ”?',
     cfg:{inverses:[{a:4,col:'#38bdf8'}]},
     c:['2ë°°','4ë°°','1/2ë°°','ë³€í•˜ì§€ ì•ŠìŒ'],ans:2,fill:'1/2ë°°',
     hint:'xy=4 (ì¼ì •). xê°€ 2ë°°ì´ë©´ yëŠ”?',
     st:['xy = 4ë¡œ ì¼ì •','x â†’ 2xì´ë©´','2x Ã— y\' = 4 â†’ y\' = 4/(2x) = y/2','â†’ yëŠ” <strong>1/2ë°°</strong>'],ans_txt:'1/2ë°°'},
    {q:'ë‘ ë°˜ë¹„ë¡€ y=3/xì™€ y=6/x ì¤‘ ì›ì ì—ì„œ ë” ë©€ë¦¬ ìœ„ì¹˜í•œ ê²ƒì€?',
     cfg:{inverses:[{a:3,col:'#34d399',label:'y=3/x'},{a:6,col:'#f87171',label:'y=6/x'}]},
     c:['y=3/x','y=6/x','ê°™ë‹¤','ì•Œ ìˆ˜ ì—†ë‹¤'],ans:1,fill:'y=6/x',
     hint:'|a|ê°€ í´ìˆ˜ë¡ ì›ì ì—ì„œ ë” ë©€ë¦¬ ìœ„ì¹˜í•©ë‹ˆë‹¤.',
     st:['y=3/x: |a|=3','y=6/x: |a|=6','|6|>|3| â†’ <strong>y=6/xê°€ ì›ì ì—ì„œ ë” ë©€ë¦¬</strong>'],ans_txt:'y=6/x'},
    {q:'y = a/xì—ì„œ ì  (-2, 5)ê°€ ê·¸ë˜í”„ ìœ„ì— ìˆë‹¤. aëŠ”?',
     cfg:{inverses:[{a:-10,col:'#f59e0b'}],pts:[{x:-2,y:5,col:'#fbbf24',lbl:'(-2,5)',cross:true}]},
     c:['a=10','a=-10','a=2.5','a=-2.5'],ans:1,fill:'-10',
     hint:'a = x Ã— y = (-2) Ã— 5',
     st:['a = x Ã— y','= (-2) Ã— 5','= <strong>-10</strong>'],ans_txt:'a=-10'},
    {q:'y = 20/xì—ì„œ x=5ì¼ ë•Œ yëŠ”?',
     cfg:{inverses:[{a:20,col:'#a78bfa'}],pts:[{x:5,y:4,col:'#fbbf24',lbl:'(5,?)',cross:true}]},
     c:['y=2','y=4','y=5','y=100'],ans:1,fill:'4',
     hint:'y = 20 Ã· 5',
     st:['y = 20/5','= <strong>4</strong>'],ans_txt:'y=4'},
    {q:'ë°˜ë¹„ë¡€ y = -9/xì—ì„œ x=-3ì¼ ë•Œ yëŠ”?',
     cfg:{inverses:[{a:-9,col:'#f87171'}],pts:[{x:-3,y:3,col:'#fbbf24',lbl:'(-3,?)',cross:true}]},
     c:['y=3','y=-3','y=27','y=-27'],ans:0,fill:'3',
     hint:'y = -9 Ã· (-3) = ?',
     st:['y = -9 / (-3)','= <strong>3</strong> (ìŒìˆ˜Ã·ìŒìˆ˜=ì–‘ìˆ˜)'],ans_txt:'y=3'},
  ],
  // CH3: ì¼ì°¨í•¨ìˆ˜
  [
    {q:'ì´ ê·¸ë˜í”„ì˜ ê¸°ìš¸ê¸°ëŠ”? (y = mx + b)',
     cfg:{lines:[{m:2,b:-3,col:'#34d399',label:'y=2x-3'}],
      pts:[{x:0,y:-3,col:'#fbbf24',lbl:'(0,-3)'},{x:1,y:-1,col:'#38bdf8',lbl:'(1,-1)'}]},
     c:['m=-3','m=2','m=3','m=-2'],ans:1,fill:'2',
     hint:'ê¸°ìš¸ê¸° = yì˜ ë³€í™”ëŸ‰ Ã· xì˜ ë³€í™”ëŸ‰',
     st:['ë‘ ì  (0,-3), (1,-1) ì´ìš©','ê¸°ìš¸ê¸° = (-1-(-3))Ã·(1-0)','= 2Ã·1 = <strong>2</strong>'],ans_txt:'m=2'},
    {q:'y = 3x - 1ì˜ yì ˆí¸ì€?',
     cfg:{lines:[{m:3,b:-1,col:'#38bdf8',label:'y=3x-1'}],pts:[{x:0,y:-1,col:'#fbbf24',lbl:'yì ˆí¸',cross:true}]},
     c:['yì ˆí¸=3','yì ˆí¸=-1','yì ˆí¸=1','yì ˆí¸=-3'],ans:1,fill:'-1',
     hint:'yì ˆí¸: x=0ì„ ëŒ€ì…í•œ yê°’',
     st:['x=0 ëŒ€ì…: y = 3Ã—0 - 1','= -1','yì ˆí¸ = <strong>-1</strong>'],ans_txt:'yì ˆí¸=-1'},
    {q:'y = -x + 4ì˜ xì ˆí¸ì€?',
     cfg:{lines:[{m:-1,b:4,col:'#f59e0b',label:'y=-x+4'}],pts:[{x:4,y:0,col:'#fbbf24',lbl:'xì ˆí¸',cross:true}]},
     c:['xì ˆí¸=1','xì ˆí¸=4','xì ˆí¸=-4','xì ˆí¸=2'],ans:1,fill:'4',
     hint:'xì ˆí¸: y=0ìœ¼ë¡œ ë†“ê³  í’€ê¸°',
     st:['y=0 ëŒ€ì…: 0 = -x+4','x = 4','xì ˆí¸ = <strong>4</strong>'],ans_txt:'xì ˆí¸=4'},
    {q:'ë‘ ì  (1,3), (3,7)ì„ ì§€ë‚˜ëŠ” ì¼ì°¨í•¨ìˆ˜ì˜ ê¸°ìš¸ê¸°ëŠ”?',
     cfg:{lines:[{m:2,b:1,col:'#a78bfa',label:'y=2x+1'}],
      pts:[{x:1,y:3,col:'#fbbf24',lbl:'(1,3)'},{x:3,y:7,col:'#34d399',lbl:'(3,7)'}]},
     c:['m=1','m=2','m=3','m=4'],ans:1,fill:'2',
     hint:'m = (7-3) Ã· (3-1)',
     st:['m = (yâ‚‚-yâ‚)Ã·(xâ‚‚-xâ‚)','= (7-3)Ã·(3-1)','= 4Ã·2 = <strong>2</strong>'],ans_txt:'m=2'},
    {q:'ê¸°ìš¸ê¸° 3, yì ˆí¸ -2ì¸ ì¼ì°¨í•¨ìˆ˜ì˜ ì‹ì€?',
     cfg:{lines:[{m:3,b:-2,col:'#f87171',label:'y=3x-2'}]},
     c:['y=3x+2','y=-3x-2','y=3x-2','y=2x-3'],ans:2,fill:'y=3x-2',
     hint:'y = mx + bì— m=3, b=-2 ëŒ€ì…',
     st:['ê¸°ìš¸ê¸° m=3, yì ˆí¸ b=-2','y = mx+bì— ëŒ€ì…','y = <strong>3x-2</strong>'],ans_txt:'y=3x-2'},
    {q:'y = 2x + bê°€ ì  (1, 5)ë¥¼ ì§€ë‚  ë•Œ bëŠ”?',
     cfg:{lines:[{m:2,b:3,col:'#34d399',label:'y=2x+3'}],pts:[{x:1,y:5,col:'#fbbf24',lbl:'(1,5)',cross:true}]},
     c:['b=1','b=2','b=3','b=5'],ans:2,fill:'3',
     hint:'5 = 2Ã—1 + b â†’ b = ?',
     st:['ì (1,5)ë¥¼ y=2x+bì— ëŒ€ì…','5 = 2Ã—1 + b','5 = 2 + b â†’ b = <strong>3</strong>'],ans_txt:'b=3'},
    {q:'y = 2x + 3ê³¼ y = 2x - 1ì˜ ê´€ê³„ëŠ”?',
     cfg:{lines:[{m:2,b:3,col:'#34d399',label:'y=2x+3'},{m:2,b:-1,col:'#f59e0b',label:'y=2x-1'}]},
     c:['í•œ ì ì—ì„œ ë§Œë‚¨','í‰í–‰ (ë§Œë‚˜ì§€ ì•ŠìŒ)','ì¼ì¹˜ (ì™„ì „íˆ ê°™ìŒ)','ìˆ˜ì§'],ans:1,fill:'í‰í–‰',
     hint:'ê¸°ìš¸ê¸°ê°€ ê°™ìœ¼ë©´ í‰í–‰ ë˜ëŠ” ì¼ì¹˜!',
     st:['y=2x+3: ê¸°ìš¸ê¸° 2','y=2x-1: ê¸°ìš¸ê¸° 2','ê¸°ìš¸ê¸° ê°™ê³ , yì ˆí¸ ë‹¤ë¦„ â†’ <strong>í‰í–‰</strong>'],ans_txt:'í‰í–‰'},
    {q:'xì ˆí¸=3, yì ˆí¸=6ì¸ ì¼ì°¨í•¨ìˆ˜ì˜ ê¸°ìš¸ê¸°ëŠ”?',
     cfg:{lines:[{m:-2,b:6,col:'#a78bfa',label:'y=-2x+6'}],
      pts:[{x:3,y:0,col:'#fbbf24',lbl:'(3,0)'},{x:0,y:6,col:'#38bdf8',lbl:'(0,6)'}]},
     c:['m=2','m=-2','m=3','m=-3'],ans:1,fill:'-2',
     hint:'ë‘ ì  (3,0), (0,6)ì„ ì´ìš©: m=(6-0)Ã·(0-3)',
     st:['ë‘ ì : (3,0), (0,6)','m = (6-0)Ã·(0-3)','= 6Ã·(-3) = <strong>-2</strong>'],ans_txt:'m=-2'},
    {q:'y = -3x + 6ì˜ ê·¸ë˜í”„ê°€ xì¶•, yì¶•ê³¼ ë§Œë‚˜ëŠ” ë‘ ì ì€?',
     cfg:{lines:[{m:-3,b:6,col:'#f87171',label:'y=-3x+6'}],
      pts:[{x:2,y:0,col:'#fbbf24',lbl:'xì ˆí¸(2,0)'},{x:0,y:6,col:'#34d399',lbl:'yì ˆí¸(0,6)'}]},
     c:['xì ˆí¸(3,0), yì ˆí¸(0,6)','xì ˆí¸(2,0), yì ˆí¸(0,6)','xì ˆí¸(2,0), yì ˆí¸(0,-6)','xì ˆí¸(-2,0), yì ˆí¸(0,6)'],ans:1,fill:'(2,0),(0,6)',
     hint:'y=0: xì ˆí¸ / x=0: yì ˆí¸ ê³„ì‚°',
     st:['yì ˆí¸: x=0 â†’ y=6 â†’ <strong>(0,6)</strong>','xì ˆí¸: y=0 â†’ 0=-3x+6 â†’ x=2 â†’ <strong>(2,0)</strong>'],ans_txt:'xì ˆí¸(2,0), yì ˆí¸(0,6)'},
    {q:'y = mx + 2ê°€ ì  (-1, 5)ë¥¼ ì§€ë‚  ë•Œ mì€?',
     cfg:{lines:[{m:-3,b:2,col:'#38bdf8',label:'y=-3x+2'}],pts:[{x:-1,y:5,col:'#fbbf24',lbl:'(-1,5)',cross:true}]},
     c:['m=3','m=-3','m=5','m=-5'],ans:1,fill:'-3',
     hint:'5 = mÃ—(-1) + 2 â†’ m = ?',
     st:['5 = mÃ—(-1) + 2','5-2 = -m','m = <strong>-3</strong>'],ans_txt:'m=-3'},
  ],
  // CH4: ë‘ ì§ì„ 
  [
    {q:'ë‘ ì§ì„  y=x+1ê³¼ y=-x+3ì˜ êµì ì€?',
     cfg:{
      lines:[{m:1,b:1,col:'#34d399',label:'y=x+1'},{m:-1,b:3,col:'#f59e0b',label:'y=-x+3'}],
      pts:[{x:1,y:2,col:'#fbbf24',lbl:'êµì ',cross:true}]},
     c:['(1,3)','(1,2)','(2,3)','(0,1)'],ans:1,fill:'(1,2)',
     hint:'x+1 = -x+3 â†’ 2x=2 â†’ x=1, y=?',
     st:['x+1 = -x+3','2x = 2 â†’ x=1','y = 1+1 = 2 â†’ êµì  <strong>(1,2)</strong>'],ans_txt:'(1,2)'},
    {q:'y=2x-1ê³¼ y=-x+5ì˜ êµì ì€?',
     cfg:{
      lines:[{m:2,b:-1,col:'#38bdf8',label:'y=2x-1'},{m:-1,b:5,col:'#a78bfa',label:'y=-x+5'}],
      pts:[{x:2,y:3,col:'#fbbf24',lbl:'êµì ',cross:true}]},
     c:['(2,4)','(2,3)','(3,5)','(1,2)'],ans:1,fill:'(2,3)',
     hint:'2x-1 = -x+5 â†’ 3x=6 â†’ x=2',
     st:['2x-1 = -x+5','3x = 6 â†’ x=2','y = 2Ã—2-1 = 3 â†’ <strong>(2,3)</strong>'],ans_txt:'(2,3)'},
    {q:'y=3xì™€ y=x+4ì˜ êµì ì€?',
     cfg:{
      lines:[{m:3,b:0,col:'#f87171',label:'y=3x'},{m:1,b:4,col:'#34d399',label:'y=x+4'}],
      pts:[{x:2,y:6,col:'#fbbf24',lbl:'êµì ',cross:true}]},
     c:['(1,3)','(2,6)','(2,8)','(4,12)'],ans:1,fill:'(2,6)',
     hint:'3x = x+4 â†’ 2x=4 â†’ x=2',
     st:['3x = x+4','2x = 4 â†’ x=2','y = 3Ã—2 = 6 â†’ <strong>(2,6)</strong>'],ans_txt:'(2,6)'},
    {q:'y=x+2ì™€ y=x-1ì˜ ê´€ê³„ëŠ”?',
     cfg:{lines:[{m:1,b:2,col:'#34d399',label:'y=x+2'},{m:1,b:-1,col:'#f87171',label:'y=x-1'}]},
     c:['êµì : (0,1)','êµì : (3,5)','í‰í–‰ (êµì  ì—†ìŒ)','ì¼ì¹˜'],ans:2,fill:'í‰í–‰',
     hint:'ê¸°ìš¸ê¸°ê°€ ê°™ê³  yì ˆí¸ì´ ë‹¤ë¥´ë©´?',
     st:['y=x+2: ê¸°ìš¸ê¸°=1','y=x-1: ê¸°ìš¸ê¸°=1','ê¸°ìš¸ê¸° ê°™ê³  yì ˆí¸ ë‹¤ë¦„','â†’ <strong>í‰í–‰</strong> (êµì  ì—†ìŒ)'],ans_txt:'í‰í–‰ (êµì  ì—†ìŒ)'},
    {q:'y=2x+3ê³¼ y=-xì˜ êµì ì€?',
     cfg:{
      lines:[{m:2,b:3,col:'#a78bfa',label:'y=2x+3'},{m:-1,b:0,col:'#f59e0b',label:'y=-x'}],
      pts:[{x:-1,y:1,col:'#fbbf24',lbl:'êµì ',cross:true}]},
     c:['(-1,1)','(1,-1)','(-1,-1)','(1,1)'],ans:0,fill:'(-1,1)',
     hint:'2x+3 = -x â†’ 3x=-3 â†’ x=-1',
     st:['2x+3 = -x','3x = -3 â†’ x=-1','y = -(-1) = 1 â†’ <strong>(-1,1)</strong>'],ans_txt:'(-1,1)'},
    {q:'y = ax+1ê³¼ y = 2x-3ì´ êµì ì´ ì—†ìœ¼ë ¤ë©´ aëŠ”?',
     cfg:{lines:[{m:2,b:1,col:'#34d399',label:'y=ax+1'},{m:2,b:-3,col:'#f87171',label:'y=2x-3'}]},
     c:['a=1','a=2','a=-2','a=3'],ans:1,fill:'2',
     hint:'êµì  ì—†ìŒ = í‰í–‰ = ê¸°ìš¸ê¸° ê°™ìŒ',
     st:['êµì  ì—†ìŒ â†’ í‰í–‰','í‰í–‰ â†’ ê¸°ìš¸ê¸°ê°€ ê°™ì•„ì•¼','a = <strong>2</strong>'],ans_txt:'a=2'},
    {q:'y=x+3ê³¼ y=2x+1ì˜ êµì ì˜ xì¢Œí‘œëŠ”?',
     cfg:{
      lines:[{m:1,b:3,col:'#34d399',label:'y=x+3'},{m:2,b:1,col:'#38bdf8',label:'y=2x+1'}],
      pts:[{x:2,y:5,col:'#fbbf24',lbl:'êµì ',cross:true}]},
     c:['x=1','x=2','x=3','x=4'],ans:1,fill:'2',
     hint:'x+3 = 2x+1 â†’ x=?',
     st:['x+3 = 2x+1','3-1 = 2x-x','x = <strong>2</strong>'],ans_txt:'x=2'},
    {q:'ë‘ ì§ì„  y=3x-2, y=-2x+8ì˜ êµì ì˜ yì¢Œí‘œëŠ”?',
     cfg:{
      lines:[{m:3,b:-2,col:'#f59e0b',label:'y=3x-2'},{m:-2,b:8,col:'#a78bfa',label:'y=-2x+8'}],
      pts:[{x:2,y:4,col:'#fbbf24',lbl:'êµì ',cross:true}]},
     c:['y=2','y=4','y=6','y=8'],ans:1,fill:'4',
     hint:'3x-2=-2x+8 â†’ 5x=10 â†’ x=2 â†’ y=?',
     st:['3x-2 = -2x+8','5x = 10 â†’ x=2','y = 3Ã—2-2 = <strong>4</strong>'],ans_txt:'y=4'},
    {q:'y=x+1, y=2x-1, y=-x+5 ì„¸ ì§ì„ ì´ í•œ ì ì—ì„œ ë§Œë‚˜ëŠ”ê°€?',
     cfg:{
      lines:[{m:1,b:1,col:'#34d399',label:'y=x+1'},{m:2,b:-1,col:'#f87171',label:'y=2x-1'},{m:-1,b:5,col:'#38bdf8',label:'y=-x+5'}],
      pts:[{x:2,y:3,col:'#fbbf24',lbl:'(2,3)',cross:true}]},
     c:['ì˜ˆ, (2,3)ì—ì„œ ë§Œë‚¨','ì•„ë‹ˆì˜¤, ê°ê° ë‹¤ë¥¸ ì ','y=x+1ê³¼ y=2x-1ë§Œ ë§Œë‚¨','í‰í–‰í•œ ìŒì´ ìˆìŒ'],ans:0,fill:'ì˜ˆ(2,3)',
     hint:'y=x+1ê³¼ y=2x-1ì˜ êµì ì„ êµ¬í•œ í›„, ì„¸ ë²ˆì§¸ ì§ì„ ë„ ê·¸ ì ì„ ì§€ë‚˜ëŠ”ì§€ í™•ì¸',
     st:['y=x+1 = y=2x-1 â†’ x=2, y=3','êµì  (2,3)ì´ y=-x+5ì— ìˆëŠ”ì§€','3 = -2+5 = 3 âœ“ â†’ ì„¸ ì§ì„  ëª¨ë‘ <strong>(2,3)</strong>ì—ì„œ ë§Œë‚¨'],ans_txt:'ì˜ˆ, (2,3)ì—ì„œ ë§Œë‚¨'},
    {q:'y = mx + 3ê³¼ y = 2x + mì´ êµì ì´ ë¬´í•œíˆ ë§ìœ¼ë ¤ë©´ mì€?',
     cfg:{lines:[{m:2,b:3,col:'#38bdf8',label:'ì¼ì¹˜'}]},
     c:['m=1','m=2','m=3','m=6'],ans:2,fill:'3',
     hint:'ì™„ì „íˆ ê°™ì€ ì§ì„  â†’ ê¸°ìš¸ê¸°ì™€ yì ˆí¸ ëª¨ë‘ ê°™ì•„ì•¼',
     st:['ì¼ì¹˜ ì¡°ê±´: ê¸°ìš¸ê¸° ê°™ê³  yì ˆí¸ ê°™ìŒ','ê¸°ìš¸ê¸°: m = 2','yì ˆí¸: 3 = m â†’ m=3','â†’ m = <strong>3</strong> (ë‘ ì¡°ê±´ ëª¨ë‘ í™•ì¸!)'],ans_txt:'m=3'},
  ],
];

// =====================================================
// STATE
// =====================================================
const S={
  score:0,combo:0,maxCombo:0,
  chapter:0,qIdx:0,
  chPts:0,correct:0,total:0,
  timer:null,timeLeft:35,
  unlocked:[true,true,true,true,true],
  done:[false,false,false,false,false],
  qList:[],curQ:null,
  lecSlide:0,
};
function loadSave(){
  try{
    const d=JSON.parse(localStorage.getItem('graph_v1')||'{}');
    if(d.score!=null) S.score=d.score;
    if(d.unlocked) S.unlocked=d.unlocked;
    if(d.done) S.done=d.done;
  }catch(e){}
}
function saveSave(){
  localStorage.setItem('graph_v1',JSON.stringify({score:S.score,unlocked:S.unlocked,done:S.done}));
}
function resetSave(){localStorage.removeItem('graph_v1');location.reload();}

// =====================================================
// SCREENS
// =====================================================
function showScreen(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}
function goHome(){clearTimer();showScreen('sc-title');renderTitle();}

// =====================================================
// TITLE
// =====================================================
function renderTitle(){
  document.getElementById('t-score').textContent=S.score.toLocaleString();
  document.getElementById('t-mode').textContent='ğŸ“ ê°ê´€ì‹';
  const grid=document.getElementById('ch-grid');
  grid.innerHTML=CH_META.map((m,i)=>`
    <div class="ch-card ${S.unlocked[i]?'':'locked'} ${S.done[i]?'done':''}"
      onclick="${S.unlocked[i]?`openChapter(${i})`:''}">
      ${!S.unlocked[i]?`<span class="lock-icon">ğŸ”’</span>`:''}
      <div class="ch-num">Chapter ${i+1}</div>
      <div class="ch-emoji">${m.emoji}</div>
      <div class="ch-title">${m.title}</div>
      <div class="ch-status">${m.sub}<br>${S.done[i]?'âœ… ì™„ë£Œ':'ğŸ¯ ë„ì „'}</div>
    </div>`).join('');
}

// =====================================================
// LECTURE
// =====================================================
function openChapter(idx){
  S.chapter=idx;S.lecSlide=0;
  renderLec();
  document.getElementById('lec-overlay').classList.add('show');
}
function renderLec(){
  const slides=LECS[S.chapter];
  const sl=slides[S.lecSlide];
  const dots=document.getElementById('lec-dots');
  dots.innerHTML=slides.map((_,i)=>`<div class="ldot ${i<S.lecSlide?'past':i===S.lecSlide?'on':''}"></div>`).join('');
  document.getElementById('lec-badge').textContent=sl.badge||'ê°œë…';
  document.getElementById('lec-h').innerHTML=sl.h;
  document.getElementById('lec-b').innerHTML=sl.b;
  // lecture canvas
  const cw=document.getElementById('lec-cwrap');
  if(sl.lcfg){
    cw.style.display='flex';
    const lc=document.getElementById('lec-canvas');
    drawScene(lc,sl.lcfg);
  } else { cw.style.display='none'; }
  // formula
  const fbox=document.getElementById('lec-formula');
  if(sl.formula){fbox.style.display='block';document.getElementById('lec-fval').textContent=sl.formula;
    document.getElementById('lec-fnote').textContent=sl.fnote||'';}
  else fbox.style.display='none';
  // tip
  const tipEl=document.getElementById('lec-tip');
  if(sl.tip){tipEl.style.display='block';tipEl.innerHTML='ğŸ’¡ '+sl.tip;}
  else tipEl.style.display='none';
  // nav buttons
  const prev=document.getElementById('l-prev');
  prev.style.visibility=S.lecSlide>0?'visible':'hidden';
  const next=document.getElementById('l-next');
  if(S.lecSlide<slides.length-1){
    next.textContent='ë‹¤ìŒ â†’';next.className='l-next';
    next.onclick=lecNext;
  } else {
    next.textContent='ğŸš€ ìˆ˜ì‚¬ ì‹œì‘!';next.className='l-start';
    next.onclick=startQuiz;
  }
}
function lecNext(){
  if(S.lecSlide<LECS[S.chapter].length-1){S.lecSlide++;renderLec();}
  else startQuiz();
}
function lecPrev(){if(S.lecSlide>0){S.lecSlide--;renderLec();}}

// =====================================================
// QUIZ
// =====================================================
function startQuiz(){
  document.getElementById('lec-overlay').classList.remove('show');
  S.qList=shuffle([...QS[S.chapter]]);
  S.qIdx=0;S.combo=0;S.maxCombo=0;
  S.chPts=0;S.correct=0;S.total=0;
  showScreen('sc-quiz');
  updateUI();renderQ();
}
function renderConceptPanel(){
  const con=CONCEPTS[S.chapter];
  if(!con){document.getElementById('concept-panel').innerHTML='';return;}
  document.getElementById('concept-panel').innerHTML=`
    <div class="cp-title">${con.title}</div>
    <div class="cp-formulas">
      ${con.formulas.map(f=>`
        <div class="cp-f-row">
          <span class="cp-f-lbl">${f.lbl}</span>
          <span class="cp-f-val">${f.val}</span>
        </div>`).join('')}
    </div>
    <div>
      <div class="cp-why-title">ğŸ’¡ ì™œ ê·¸ëŸ´ê¹Œ?</div>
      ${con.whys.map(w=>`
        <div class="cp-why-item">
          <div class="cp-why-q">${w.q}</div>
          <div class="cp-why-a">${w.a}</div>
        </div>`).join('')}
    </div>`;
}
function renderQ(){
  if(S.qIdx>=S.qList.length){endChapter();return;}
  const q=S.qList[S.qIdx]; S.curQ=q;
  const cm=CH_META[S.chapter];
  document.getElementById('canvas-tag').textContent=`ğŸ“Š ${cm.emoji} ${cm.title} â€” ${cm.sub}`;
  document.getElementById('canvas-qn').textContent=`ë¬¸ì œ ${S.qIdx+1} / ${S.qList.length}`;
  document.getElementById('q-text').textContent=q.q;
  document.getElementById('q-ctr').textContent=`${S.qIdx+1} / ${S.qList.length}`;
  // Draw graph
  const canvas=document.getElementById('graph-canvas');
  const {ctx}=initCanvas(canvas);
  drawScene(canvas, q.cfg||{});
  renderConceptPanel();
  renderMCQ(q);
  startTimer();
}
function renderMCQ(q){
  const idxs=shuffle([0,1,2,3]);
  const corPos=idxs.indexOf(q.ans);
  S.curCorrectIdx=corPos;
  document.getElementById('choices').style.display='grid';
  document.getElementById('choices').innerHTML=idxs.map((orig,i)=>`
    <button class="cbtn" onclick="checkMCQ(${i},${corPos})">
      <span style="color:var(--muted);margin-right:.35rem">${['â‘ ','â‘¡','â‘¢','â‘£'][i]}</span>${q.c[orig]}
    </button>`).join('');
}
// =====================================================
// ANSWER CHECKING
// =====================================================
function checkMCQ(idx,correctIdx){
  clearTimer();
  const btns=document.querySelectorAll('.cbtn');
  btns.forEach(b=>b.disabled=true);
  const ok=idx===correctIdx;
  btns[idx].classList.add(ok?'correct':'wrong');
  if(!ok) btns[correctIdx].classList.add('correct');
  flash(ok);
  S.total++;
  if(ok){S.correct++;processCorrect();}else{processWrong();}
  setTimeout(()=>showExp(ok),400);
}
function processCorrect(){
  S.combo++;S.maxCombo=Math.max(S.maxCombo,S.combo);
  const mult=S.combo>=10?5:S.combo>=5?3:S.combo>=3?2:1;
  const pts=10*mult;
  S.score+=pts;S.chPts+=pts;
  updateUI();
}
function processWrong(){S.combo=0;updateUI();}

// =====================================================
// EXPLANATION
// =====================================================
function showExp(ok){
  const q=S.curQ;
  const modal=document.getElementById('exp-modal');
  modal.className='exp-modal'+(ok?' ok':'');
  document.getElementById('exp-icon').textContent=ok?'âœ¨':'ğŸ’¥';
  const title=document.getElementById('exp-title');
  title.textContent=ok?'ì •ë‹µ!':'í‹€ë ¸ìŠµë‹ˆë‹¤';
  title.className='exp-title'+(ok?' ok':'');
  document.getElementById('exp-ans-val').textContent=q.ans_txt;
  const steps=document.getElementById('exp-steps');
  steps.innerHTML=q.st.map((s,i)=>`<li style="animation-delay:${i*0.08}s">${s}</li>`).join('');
  document.getElementById('exp-overlay').classList.add('show');
}
function closeExp(){
  document.getElementById('exp-overlay').classList.remove('show');
  S.qIdx++;renderQ();
}
function flash(ok){
  const el=document.getElementById('flash');
  el.className='flash '+(ok?'ok':'red');
  void el.offsetWidth;
  el.className='flash '+(ok?'ok':'red');
}

// =====================================================
// HINT
// =====================================================
function showHint(){
  document.getElementById('hint-body').textContent=S.curQ.hint;
  document.getElementById('hint-overlay').classList.add('show');
}
function closeHint(){document.getElementById('hint-overlay').classList.remove('show');}

// =====================================================
// TIMER
// =====================================================
function startTimer(){
  clearTimer();S.timeLeft=35;
  const bar=document.getElementById('timer-bar');
  bar.style.width='100%';bar.className='timer-bar';
  S.timer=setInterval(()=>{
    S.timeLeft--;
    const pct=(S.timeLeft/35)*100;
    bar.style.width=pct+'%';
    if(S.timeLeft<=10)bar.className='timer-bar warn';
    if(S.timeLeft<=0){clearTimer();timeUp();}
  },1000);
}
function clearTimer(){if(S.timer){clearInterval(S.timer);S.timer=null;}}
function timeUp(){
  flash(false);S.combo=0;S.total++;updateUI();
  setTimeout(()=>showExp(false),200);
}
function updateUI(){
  document.getElementById('q-score').textContent=S.score.toLocaleString();
  const el=document.getElementById('combo-el');
  const c=S.combo;
  const mult=c>=10?5:c>=5?3:c>=3?2:1;
  const cls=c>=10||c>=5?'c5':c>=3?'c3':c>=1?'c2':'c0';
  el.className='combo-el '+cls;
  el.textContent=c>=1?`ğŸ”¥ ${c}ì½¤ë³´ Ã—${mult}`:'ì½¤ë³´ Ã—1';
}
// =====================================================
// CHAPTER END
// =====================================================
function endChapter(){
  clearTimer();
  S.done[S.chapter]=true;
  if(S.chapter+1<5) S.unlocked[S.chapter+1]=true;
  saveSave();
  const acc=S.total>0?Math.round(S.correct/S.total*100):0;
  const emoji=acc>=80?'ğŸ†':acc>=60?'â­':'ğŸ’ª';
  document.getElementById('done-emoji').textContent=emoji;
  document.getElementById('done-title').textContent=
    acc>=80?'ì™„ë²½í•œ ì´í•´!':acc>=60?'ì˜ í–ˆì–´ìš”!':'ì¡°ê¸ˆ ë” ì—°ìŠµí•´ë´ìš”!';
  document.getElementById('done-pts').textContent=`+${S.chPts.toLocaleString()}ì `;
  document.getElementById('d-acc').textContent=acc+'%';
  document.getElementById('d-combo').textContent=S.maxCombo+'ì½¤ë³´';
  document.getElementById('d-total').textContent=S.score.toLocaleString()+'ì ';
  document.getElementById('d-mode').textContent='ğŸ“ê°ê´€ì‹';
  const nb=document.getElementById('btn-nxt');
  if(S.chapter<4){
    nb.style.display='block';
    nb.textContent=`${CH_META[S.chapter+1].emoji} ë‹¤ìŒ: ${CH_META[S.chapter+1].title} â†’`;
  } else nb.style.display='none';
  showScreen('sc-done');
}
function nextChapter(){
  if(S.chapter<4) openChapter(S.chapter+1);
  else goHome();
}

// =====================================================
// UTILS
// =====================================================
function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a;}

// INIT
window.onload=function(){
  loadSave();renderTitle();
  // resize canvas on window resize
  window.addEventListener('resize',()=>{
    if(S.curQ){
      const canvas=document.getElementById('graph-canvas');
      initCanvas(canvas);
      drawScene(canvas,S.curQ.cfg||{});
    }
  });
};
</script>
</body>
</html>
